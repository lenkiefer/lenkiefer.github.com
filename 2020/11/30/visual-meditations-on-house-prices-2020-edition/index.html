<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Reflecting on recent house price trends with variations on a theme">
  <meta name="generator" content="Hugo 0.81.0" />

  <title>Visual Meditations on House Prices 2020 Edition &middot; Len Kiefer</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://lenkiefer.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://lenkiefer.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://lenkiefer.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://lenkiefer.com/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="http://lenkiefer.com/">Len Kiefer</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/post/"><i class='fa fa-list fa-fw'></i>Archive</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/@lenkiefer" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/leonard-kiefer-51175331" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/lenkiefer" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2021. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


       <meta name="twitter:card" content="summary_large_image">
       <meta name="twitter:image" content="http://lenkiefer.com//img/charts_2020_11_30/fmhpi_state_202010_geofacet.png" >
     
    <meta property="og:title" content="Visual Meditations on House Prices 2020 Edition">
    <meta property="og:description" content="Reflecting on recent house price trends with variations on a theme">

<div class="header">
  <h1>Visual Meditations on House Prices 2020 Edition</h1>
  <h2>Reflecting on recent house price trends with variations on a theme</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2020/11/30</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/dataviz">dataviz</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/house-prices">house prices</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/r">R</a>
    
  </div>
  
  

</div>

  


<p>VISUAL MEDITATIONS are the analysis of repeated graphs of the same data with variations on a graphical theme. When altering the mapping of data to aesthetics sometimes interesting patterns emerge. I find it a useful practice. I made a <a href="http://lenkiefer.com/2016/05/08/visual-meditations-on-house-prices/">series of these a few years ago with different charts</a>. The chart images have been lost to past blog migrations, but the code should still work.</p>
<p>In this post, I want to consider several alternative ways to visualize house prices. We’ll use the <a href="http://www.freddiemac.com/research/indices/house-price-index.page">Freddie Mac House Price Index</a> and visualize the data with <a href="https://www.r-project.org/">R</a> (code at the bottom).</p>
<p>Throughout we’ll be looking at the annualized rate of change over 3-month sliding windows. For example, the latest data is through October 2020, so the rate of change we’re looking at is from July to October (growth in August, September, October).</p>
<p>The graph below shows that after slowing in spring, US house prices <a href="../../../../2020/10/27/us-house-prices-accelerate/">accelerated</a> to a nearly 20 percent annualized growth rate over the past three months.</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_usa_202010.png" style="width:740px" alt="US House Price growth"></p>
<div id="variation-1-state-trends-with-geofacet" class="section level2">
<h2>Variation 1: State trends with geofacet</h2>
<p>But that national trend masks a lot of variations across states. Let’s map it out:</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_state_202010_geofacet.png" style="width:740px" alt="US State House Price growth"></p>
<p>Here we can see that the acceleration is much higher in certain states like Idaho (ID) and Vermont (VT). Idaho’s house price growth rate is nearly double the US rate.</p>
</div>
<div id="variation-2-state-trends-segment" class="section level2">
<h2>Variation 2: State trends segment</h2>
<p>Let’s change up the mapping. Instead of using geo facets we can simply plot each state on the y axis and compare them vertically, with house price growth on the x axis. We’ll add a line segment that reached back 3 months and shows the relative trend. If the segment extends left, that means the state had slower growth 3 months ago and house price have accelerated. If the segment extends right, the oppostite.</p>
<p>Let’s consider February of 2020, before the COVID-19 pandemic hit the US economy.</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_state_20202.png" style="width:740px" alt="US State House Price growth"></p>
<p>For most, but not all states, the segment extends left, meaning price growth from December 2019 to February 2020 was higher than from October to December 2019.</p>
<p>Let’s roll foward 3 months to the period covering February 2020 to May 2020 compared to December 2019 to February 2020.</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_state_20205.png" style="width:740px" alt="US State House Price growth"></p>
<p>Here we see that many states were slowing down. At that point, it was reasonable to be concerned that the housing market would falter. But it did not. Thanks to low mortgage interest rate and policies like forbearance and foreclosure moratoria, the housing marke rebounded. Let’s look at the latest data:</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_state_202010.png" style="width:740px" alt="US State House Price growth"></p>
<p>In October 2020, most states are experiencing a rapid acceleration in house prices. WIth Idaho (ID) leading the way.</p>
</div>
<div id="variation-3-state-trends-segment-animated" class="section level2">
<h2>Variation 3: State trends segment animated</h2>
<p>Now that we’ve build individual frames, let’s watch the animation unfold:</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_dots_nov2020v5.gif" style="width:740px" alt="US State House Price growth animated segment"></p>
<p>Here I think animation does a lot to help. You can see the acceleration in the plot.</p>
</div>
<div id="variation-4-state-trends-bar-animated" class="section level2">
<h2>Variation 4: State trends bar animated</h2>
<p>Finally, we can go back to our original bar chart, and cycle through states. I’ve sorted states from the slowest growing in October 2020 (Hawaii HI) to the fastest (Idaho ID).</p>
<p><img src="../../../../img/charts_2020_11_30/fmhpi_bars_nov2020_allv2.gif" style="width:740px" alt="US State House Price growth bar"></p>
<p>All these charts show us the same data, but in new ways that perhaps lead to some insights.</p>
</div>
<div id="r-code" class="section level2">
<h2>R Code</h2>
<p>R code for the plots above can be found below.</p>
<pre class="r"><code># replace with path to save your files
mydir &lt;- FILEPATH


#####################################################################################
# load libraries----
#####################################################################################
library(darklyplot) # for theme_dark2() function
# see http://lenkiefer.com/2020/07/03/using-darklyplot/ 

library(gganimate)
library(data.table)
library(tidyverse)
library(geofacet)

#####################################################################################
# color palette ----
#####################################################################################
# a color function for rainbow palette
# Function for colors ----
# adapted from https://drsimonj.svbtle.com/creating-corporate-colour-palettes-for-ggplot2
#####################################################################################
## Make Color Scale ----  ##
#####################################################################################
my_colors &lt;- c(
  &quot;green&quot;      = rgb(103,180,75, maxColorValue = 256),
  &quot;green2&quot;      = rgb(147,198,44, maxColorValue = 256),
  &quot;lightblue&quot;  =  rgb(9, 177,240, maxColorValue = 256),
  &quot;lightblue2&quot; = rgb(173,216,230, maxColorValue = 256),
  &#39;blue&#39;       = &quot;#00aedb&quot;,
  &#39;red&#39;        = &quot;#d11141&quot;,
  &#39;orange&#39;     = &quot;#f37735&quot;,
  &#39;yellow&#39;     = &quot;#ffc425&quot;,
  &#39;gold&#39;       = &quot;#FFD700&quot;,
  &#39;light grey&#39; = &quot;#cccccc&quot;,
  &#39;purple&#39;     = &quot;#551A8B&quot;,
  &#39;dark grey&#39;  = &quot;#8c8c8c&quot;)


my_cols &lt;- function(...) {
  cols &lt;- c(...)
  if (is.null(cols))
    return (my_colors)
  my_colors[cols]
}


my_palettes &lt;- list(
  `main`  = my_cols(&quot;blue&quot;, &quot;green&quot;, &quot;yellow&quot;),
  `cool`  = my_cols(&quot;blue&quot;, &quot;green&quot;),
  `cool2hot` = my_cols(&quot;lightblue2&quot;,&quot;lightblue&quot;, &quot;blue&quot;,&quot;green&quot;, &quot;green2&quot;,&quot;yellow&quot;,&quot;gold&quot;, &quot;orange&quot;, &quot;red&quot;),
  `hot`   = my_cols(&quot;yellow&quot;, &quot;orange&quot;, &quot;red&quot;),
  `mixed` = my_cols(&quot;lightblue&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;orange&quot;, &quot;red&quot;),
  `mixed2` = my_cols(&quot;lightblue2&quot;,&quot;lightblue&quot;, &quot;green&quot;, &quot;green2&quot;,&quot;yellow&quot;,&quot;gold&quot;, &quot;orange&quot;, &quot;red&quot;),
  `mixed3` = my_cols(&quot;lightblue2&quot;,&quot;lightblue&quot;, &quot;green&quot;, &quot;yellow&quot;,&quot;gold&quot;, &quot;orange&quot;, &quot;red&quot;),
  `mixed4` = my_cols(&quot;lightblue2&quot;,&quot;lightblue&quot;, &quot;green&quot;, &quot;green2&quot;,&quot;yellow&quot;,&quot;gold&quot;, &quot;orange&quot;, &quot;red&quot;,&quot;purple&quot;),
  `mixed5` = my_cols(&quot;lightblue&quot;,&quot;green&quot;, &quot;green2&quot;,&quot;yellow&quot;,&quot;gold&quot;, &quot;orange&quot;, &quot;red&quot;,&quot;purple&quot;,&quot;blue&quot;),
  `mixed6` = my_cols(&quot;green&quot;, &quot;gold&quot;, &quot;orange&quot;, &quot;red&quot;,&quot;purple&quot;,&quot;blue&quot;),
  `grey`  = my_cols(&quot;light grey&quot;, &quot;dark grey&quot;)
)


my_pal &lt;- function(palette = &quot;main&quot;, reverse = FALSE, ...) {
  pal &lt;- my_palettes[[palette]]
  
  if (reverse) pal &lt;- rev(pal)
  
  colorRampPalette(pal, ...)
}


scale_color_mycol &lt;- function(palette = &quot;main&quot;, discrete = TRUE, reverse = FALSE, ...) {
  pal &lt;- my_pal(palette = palette, reverse = reverse)
  
  if (discrete) {
    discrete_scale(&quot;colour&quot;, paste0(&quot;my_&quot;, palette), palette = pal, ...)
  } else {
    scale_color_gradientn(colours = pal(256), ...)
  }
}



scale_fill_mycol &lt;- function(palette = &quot;main&quot;, discrete = TRUE, reverse = FALSE, ...) {
  pal &lt;- my_pal(palette = palette, reverse = reverse)
  
  if (discrete) {
    discrete_scale(&quot;fill&quot;, paste0(&quot;my_&quot;, palette), palette = pal, ...)
  } else {
    scale_fill_gradientn(colours = pal(256), ...)
  }
}


#####################################################################################
# data stuff ----
#####################################################################################
dt &lt;- fread(&quot;http://www.freddiemac.com/fmac-resources/research/docs/fmhpi_master_file.csv&quot;)

#####################################################################################
# define variables ----
#####################################################################################
dt &lt;- data.table(dt)[,&quot;:=&quot;(hpa12=Index_SA/shift(Index_SA,12)-1,
                           hpa3 = (Index_SA/shift(Index_SA,3))**4 -1 ),
                     .(GEO_Type,GEO_Name)
                     ]

dt[,date:=as.Date(ISOdate(Year,Month,15))]
dt[, hpa3_lag3:=shift(hpa3,3), by=.(GEO_Type,GEO_Name)]
dts &lt;- dt[Year&gt;2017 &amp; GEO_Type==&quot;State&quot;,]
yy &lt;- 2020
mm &lt;- 10

#####################################################################################
# plot 1 bar chart ----
#####################################################################################

ggplot(data=dt[GEO_Name==&quot;USA&quot; &amp; Year&gt;2017,]
       , aes(y=hpa3,x=date,color=hpa3,fill=hpa3))+
  geom_col(alpha=0.5)+
  geom_path()+
  geom_point()+
  geom_text(data= .%&gt;% filter(date==max(date)),
            nudge_y=.01,fontface=&quot;bold&quot;,size=4,
            aes(label=GEO_Name))+
  scale_y_continuous(labels=scales::percent_format(accuracy=1),
                     #limits=c(-0.1,.4),breaks=seq(-0.1,.4,.1),
                     position=&quot;right&quot;)+
  labs(x=&quot;&quot;,
       y=&quot;3-month annualized % change&quot;,
       title=&quot;House Price Growth (USA)&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index, seasonally adjusted&quot;,
       subtitle=paste0(format(min(dt$date),&quot;%b %Y&quot;),&quot;-&quot;,format(max(dt$date),&quot;%b %Y&quot;)))+
  theme_dark2(base_family=&quot;Arial&quot;,base_size=18)+
  theme(legend.position=&quot;top&quot;,legend.direction = &quot;horizontal&quot;,
        legend.key.width=unit(2,&quot;cm&quot;),
        plot.title=element_text(size=rel(1.75),face=&quot;bold&quot;),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank()
        #,panel.grid.major.y=element_blank()
  )+
  scale_color_mycol(palette=&quot;cool2hot&quot;,
                    discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)+
  scale_fill_mycol(palette=&quot;cool2hot&quot;,
                   discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)

ggsave(paste0(mydir,&quot;fmhpi_usa_&quot;,yy,mm,&quot;.png&quot;), height=5,width=8,scale=2)

#####################################################################################
# plot 2 geo facet bar chart ----
#####################################################################################

ggplot(data=dts, aes(y=hpa3, x=date, 
                     group=GEO_Name, fill=hpa3))+
  geom_col()+
  scale_y_continuous(labels=scales::percent_format(accuracy=1),
                     limits=c(-0.1,.4),breaks=seq(-0.1,.4,.1))+
  labs(y=&quot;&quot;,
       x=&quot;3-month annualized % change&quot;,
       title=&quot;House Price Growth by State&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index, seasonally adjusted&quot;,
       subtitle=paste0(format(min(dts$date),&quot;%b %Y&quot;), &quot;-&quot;,format(max(dts$date),&quot;%b %Y&quot;)))+
  theme_dark2(base_family=&quot;Arial&quot;,base_size=18)+
  theme(legend.position=&quot;top&quot;,legend.direction = &quot;horizontal&quot;,
        legend.key.width=unit(2,&quot;cm&quot;),
        plot.title=element_text(size=rel(1.75),face=&quot;bold&quot;)
        ,panel.grid.minor.y=element_blank()
        ,panel.grid.minor.x=element_blank()
  )+
  scale_fill_mycol(palette=&quot;cool2hot&quot;,
                   limits=c(-0.05,.38),
                   discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)+
  facet_geo(~GEO_Name)

ggsave(paste0(mydir,&quot;fmhpi_state_&quot;,yy,mm,&quot;_geofacet.png&quot;), height=8,width=14,scale=2)



#####################################################################################
# plot 3 segment chart ----
#####################################################################################


myf &lt;- function(yy=2020, mm=4){
  
  dts2 &lt;- dts[Year==yy &amp; Month==mm,]
  
  ggplot(data=dts2, aes(x=hpa3, y=GEO_Name, label=GEO_Name, color=hpa3))+
    geom_point()+
    geom_segment(aes(xend=hpa3_lag3, yend=GEO_Name))+
    geom_label(size=4,fontface=&quot;bold&quot;)+
    scale_x_continuous(labels=scales::percent_format(accuracy=1),
                       limits=c(-0.1,.4),breaks=seq(-0.1,.4,.1))+
    labs(y=&quot;&quot;,
         x=&quot;3-month annualized % change, line extends to 3-months prior&quot;,
         title=&quot;House Price Growth by State&quot;,
         caption=&quot;@lenkiefer Source: Freddie Mac House Price Index, seasonally adjusted&quot;,
         subtitle=format(max(dts2$date),&quot;%b %Y&quot;))+
    theme_dark2(base_family=&quot;Arial&quot;,base_size=18)+
    theme(legend.position=&quot;top&quot;,legend.direction = &quot;horizontal&quot;,
          legend.key.width=unit(2,&quot;cm&quot;),
          plot.title=element_text(size=rel(1.75),face=&quot;bold&quot;),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank(),
          panel.grid.major.y=element_blank())+
    scale_color_mycol(palette=&quot;cool2hot&quot;,
                      limits=c(-0.05,.38),
                      discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)
  
  ggsave(paste0(mydir,&quot;fmhpi_state_&quot;,yy,mm,&quot;.png&quot;), height=14,width=14,scale=1)
  
  
}


myf(2020,2)
myf(2020,5)
myf(2020,10)

#####################################################################################
# plot 4 animated segment chart ----
#####################################################################################

a &lt;- 
  ggplot(data=dts, aes(x=hpa3, y=GEO_Name, label=GEO_Name, color=hpa3))+
  geom_point()+
  geom_segment(aes(xend=hpa3_lag3, yend=GEO_Name))+
  geom_label(size=4,fontface=&quot;bold&quot;)+
  scale_x_continuous(labels=scales::percent_format(accuracy=1),
                     limits=c(-0.1,.4),breaks=seq(-0.1,.4,.1))+
  transition_reveal(date)+
  labs(y=&quot;&quot;,
       x=&quot;3-month annualized % change, line extends to 3-months prior&quot;,
       title=&quot;House Price Growth by State&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index, seasonally adjusted&quot;,
       subtitle=paste0(&#39;{format(frame_along,&quot;%b %Y&quot;)}&#39;))+
  theme_dark2(base_family=&quot;Arial&quot;,base_size=18)+
  theme(legend.position=&quot;top&quot;,legend.direction = &quot;horizontal&quot;,
        legend.key.width=unit(2,&quot;cm&quot;),
        plot.title=element_text(size=rel(1.75),face=&quot;bold&quot;),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        panel.grid.major.y=element_blank())+
  scale_color_mycol(palette=&quot;cool2hot&quot;,discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)

# test
# animate(a,nframes=10, end_pause=2, width=740,height=1000,fps=15)
animate(a,nframes=184, end_pause=30, width=740,height=1000,fps=15)

gganimate::anim_save(paste0(mydir,&quot;fmhpi_dots_nov2020v5.gif&quot;))


#####################################################################################
# plot 4 animated bar chart ----
#####################################################################################

dts3 &lt;- dt[Year&gt;2017 &amp; (GEO_Type==&quot;State&quot;| GEO_Type==&quot;US&quot;),]
dts3$statef &lt;- factor(dts3$GEO_Name,levels=dts3[date==max(date) ][order(hpa3),]$GEO_Name)

ab &lt;-
  ggplot(data=dts3[GEO_Name %in% c(&quot;ID&quot;,&quot;USA&quot;,&quot;HI&quot;,&quot;xVT&quot;)]
         , aes(y=hpa3,x=date,color=hpa3,fill=hpa3))+
  geom_col(alpha=0.5)+
  geom_path()+
  geom_point()+
  geom_text(data= .%&gt;% filter(date==max(date)),
            nudge_y=.02,fontface=&quot;bold&quot;,
            aes(label=GEO_Name))+
  scale_y_continuous(labels=scales::percent_format(accuracy=1),
                     limits=c(-0.1,.4),breaks=seq(-0.1,.4,.1),
                     position=&quot;right&quot;)+
  labs(x=&quot;&quot;,
       y=&quot;3-month annualized % change&quot;,
       title=&quot;House Price Growth by State&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index, seasonally adjusted&quot;,
       subtitle=&quot;{closest_state}&quot;)+
  theme_dark2(base_family=&quot;Arial&quot;,base_size=18)+
  theme(legend.position=&quot;top&quot;,legend.direction = &quot;horizontal&quot;,
        legend.key.width=unit(2,&quot;cm&quot;),
        plot.title=element_text(size=rel(1.75),face=&quot;bold&quot;)
        )+
  scale_color_mycol(palette=&quot;cool2hot&quot;,
                    discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)+
  scale_fill_mycol(palette=&quot;cool2hot&quot;,
                   discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)


animate(ab+transition_states(GEO_Name),
        nframes=30, end_pause=2, width=740,height=500)

gganimate::anim_save(paste0(mydir,&quot;fmhpi_bars_nov2020.gif&quot;))


ac &lt;-
  
  ggplot(data=dts3
         , aes(y=hpa3,x=date,color=hpa3,fill=hpa3))+
  geom_col(alpha=0.5)+
  geom_path()+
  geom_point()+
  geom_text(data= .%&gt;% filter(date==max(date)),
            nudge_y=.02,fontface=&quot;bold&quot;,
            aes(label=GEO_Name))+
  scale_y_continuous(labels=scales::percent_format(accuracy=1),
                     limits=c(-0.1,.4),breaks=seq(-0.1,.4,.1),
                     position=&quot;right&quot;)+
  labs(x=&quot;&quot;,
       y=&quot;3-month annualized % change&quot;,
       title=&quot;House Price Growth by State&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index, seasonally adjusted&quot;,
       subtitle=&quot;{closest_state}&quot;)+
  theme_dark2(base_family=&quot;Arial&quot;,base_size=18)+
  theme(legend.position=&quot;top&quot;,legend.direction = &quot;horizontal&quot;,
        legend.key.width=unit(2,&quot;cm&quot;),
        plot.title=element_text(size=rel(1.75),face=&quot;bold&quot;)
        )+
  scale_color_mycol(palette=&quot;cool2hot&quot;,
                    discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)+
  scale_fill_mycol(palette=&quot;cool2hot&quot;,
                   discrete=FALSE,label=scales::percent,name=&quot;3-month growth (annualized rate)&quot;)


animate(ac+transition_states(statef),
        nframes=176*3, end_pause=20, width=740,height=500)

gganimate::anim_save(paste0(mydir,&quot;fmhpi_bars_nov2020_allv2.gif&quot;))</code></pre>
</div>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flenkiefer.com%2f2020%2f11%2f30%2fvisual-meditations-on-house-prices-2020-edition%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=http%3a%2f%2flenkiefer.com%2f2020%2f11%2f30%2fvisual-meditations-on-house-prices-2020-edition%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=http%3a%2f%2flenkiefer.com%2f2020%2f11%2f30%2fvisual-meditations-on-house-prices-2020-edition%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=http%3a%2f%2flenkiefer.com%2f2020%2f11%2f30%2fvisual-meditations-on-house-prices-2020-edition%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2flenkiefer.com%2f2020%2f11%2f30%2fvisual-meditations-on-house-prices-2020-edition%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=http%3a%2f%2flenkiefer.com%2f2020%2f11%2f30%2fvisual-meditations-on-house-prices-2020-edition%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://lenkiefer.com/2020/11/23/new-research-paper-inequality-during-the-covid-19-pandemic-the-the-case-of-savings-from-mortgage-refinancing/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://lenkiefer.com/2020/11/23/new-research-paper-inequality-during-the-covid-19-pandemic-the-the-case-of-savings-from-mortgage-refinancing/">New Research Paper Inequality During the COVID-19 Pandemic The Case of Savings from Mortgage Refinancing</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://lenkiefer.com/2020/12/15/talking-dataviz/">Talking Dataviz</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://lenkiefer.com/2020/12/15/talking-dataviz/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="http://lenkiefer.com/js/ui.js"></script>
<script src="http://lenkiefer.com/js/menus.js"></script>




<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66905937-1', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="http://lenkiefer.com/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

