<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A guide to using the darklyplot package">
  <meta name="generator" content="Hugo 0.81.0" />

  <title>Using darklyplot &middot; Len Kiefer</title>

  
  
  <link rel="stylesheet" href="https://cdn.bootcss.com/pure/0.6.2/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdn.bootcss.com/pure/0.6.2/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <script async src="https://use.fontawesome.com/32c3d13def.js"></script>

  
  

  
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.11.0/styles/androidstudio.min.css">
  <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
  <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
  <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://lenkiefer.com/img/favicon.PNG" type="image/x-icon" />

  
  

</head>

<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">Len Kiefer</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Archive</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/@lenkiefer" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/leonard-kiefer-51175331" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/lenkiefer" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2015-2018. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


       <meta name="twitter:card" content="summary_large_image">
       <meta name="twitter:image" content="http://lenkiefer.com/img/charts_2020_07_02/darkly.png" >
     
    <meta property="og:title" content="Using darklyplot">
    <meta property="og:description" content="A guide to using the darklyplot package">

<div class="header">
  <h1>Using darklyplot</h1>
  <h2>A guide to using the darklyplot package</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2020/07/03</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/r">R</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/dataviz">dataviz</a>
    
  </div>
  
  

</div>

  


<p>Yesterday <a href="../../../../2020/07/02/a-new-r-package-darklyplot/">I announced</a> that I wrote a simple <a href="https://www.r-project.org/">R</a> package <a href="https://github.com/lenkiefer/darklyplot">darklyplot</a>. This is a vignette I have built to help explain ways you can use the package.</p>
<p>The goal of darklyplot is to create simple time series plots with a dark background. The miniminum and maximum values are highlighted, and color coded along with the y axis and x axis labels. This vignette walks through basic usage and explores some of the package options.</p>
<p>darklyplot can be installed from <a href="https://github.com/">GitHub</a> with:</p>
<pre class="r"><code># install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;lenkiefer/darklyplot&quot;)</code></pre>
<div id="a-first-plot" class="section level2">
<h2>A first plot</h2>
<p>The darklyplot package comes with a dataset <code>mtg_rate</code> which contains a time series of U.S. weekly average 30-year fixed mortgage rates from Freddie Mac’s <a href="http://www.freddiemac.com/pmms/">Primary Mortgage Market Survey</a>. The following code constructs a time series plot of the weekly values from April 2, 1971 through July 2, 2020.</p>
<pre class="r"><code>library(darklyplot)
darklyplot(df=mtg_rate,column=&quot;rate&quot;,labelx=&quot;roundx&quot;,n.decimals=3)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-1.png" width="50%" /></p>
<p>The darklyplot plot combines a dark theme with a minimalist aesthetic. Using <code>geom_rangeframe</code> from the <a href="https://jrnold.github.io/ggthemes/reference/geom_rangeframe.html">ggthemes</a> package we limit the axis to cover the minimum and maxiumum values. We also highlight the first, last, minimum and maximum value with separate axis ticks and different colors. The user can select the colors to highlight the values.</p>
<p>For example, you could force darklyplot to use only one color, white, to represent all values:</p>
<pre class="r"><code>darklyplot(df=mtg_rate,column=&quot;rate&quot;,
           labelx=&quot;roundx&quot;,n.decimals=3,
           minCol=&quot;white&quot;,maxCol=&quot;white&quot;,
           firstCol=&quot;white&quot;,lastCol=&quot;white&quot;)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-2-1.png" width="50%" /></p>
</div>
<div id="shading-and-reference-lines" class="section level2">
<h2>Shading and reference lines</h2>
<p>The darklyplot packages allows you to add a reference line to your plot. By default the reference line is set to 0, but you can adjust it to any fixed value. For example, we can modify our mortgage rate plot to add a reference line at 5 percentage points.</p>
<pre class="r"><code>darklyplot(df=mtg_rate,column=&quot;rate&quot;,labelx=&quot;roundx&quot;,n.decimals=3,
           refline=TRUE,refCol=&quot;yellow&quot;,refValue=5)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-3-1.png" width="50%" /></p>
<p>You can also shade between the reference line and the data by setting <code>shade=TRUE</code>. The default shading is <code>dodgerblue</code> with alpha set to 0.15, but you can adjust those values with the <code>shadeCol</code> and <code>shadeAlpha</code> parameters.</p>
<pre class="r"><code>darklyplot(df=mtg_rate,column=&quot;rate&quot;,labelx=&quot;roundx&quot;,n.decimals=3,
           refCol=&quot;yellow&quot;,refline=TRUE,refValue=5,
           shade=TRUE,shadeCol=&quot;yellow&quot;,shadeAlpha=0.35)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-4-1.png" width="50%" /></p>
</div>
<div id="use-with-any-time-series-data" class="section level2">
<h2>Use with any time series data</h2>
<p>You can used darklyplot with any time series as long as the data is stored a dataframe with a date formatted column called <code>date</code>, and the desired column is numeric. The <code>ggplot2</code> package comes with a dataframe called <code>txhousing</code> that has a column called date. However, it is a double not a date so if you tried to use it with darklyplot you would get an error.</p>
<p>In the example below we first filter <code>txhousing</code> to just the observations for Lubbock, Texas and try to plot sales with darklyplot. This code will result in an error</p>
<pre class="r"><code>txhousing2 &lt;- txhousing[txhousing$city==&quot;Lubbock&quot;,]

darklyplot(df=txhousing2,column=&quot;sales&quot;,labelx=&quot;roundx&quot;,n.decimals=3,
           refCol=&quot;yellow&quot;,refline=TRUE,refValue=5,
           shade=TRUE,shadeCol=&quot;yellow&quot;,shadeAlpha=0.35)</code></pre>
<pre class="r"><code>#&gt; Error: Invalid input: date_trans works with objects of class Date only</code></pre>
<p>If we convert the <code>date</code> column to date format the plot will work:</p>
<pre class="r"><code>txhousing2 &lt;- txhousing[txhousing$city==&quot;Lubbock&quot;,]
txhousing2$date &lt;- as.Date(ISOdate(txhousing2$year, txhousing2$month,1))

darklyplot(df=txhousing2,column=&quot;sales&quot;,labelx=&quot;roundx&quot;,n.decimals=3)+
  labs(title=&quot;Monthly home sales in Lubbock, Texas&quot;)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-6-1.png" width="50%" /></p>
<div id="where-is-my-minmax" class="section level3">
<h3>Where is my min/max?</h3>
<p>The plot above lacks a min/max. That is because the dataframe we created has some missing observations. Future versions of darklyplot may adjust for this, but for now we have to work around that issue:</p>
<pre class="r"><code># filter out months with missing sales data
txhousing2 &lt;- txhousing2[!is.na(txhousing2$sales),]

darklyplot(df=txhousing2,column=&quot;sales&quot;,labelx=&quot;roundx&quot;,n.decimals=3)+
  labs(title=&quot;Monthly home sales in Lubbock, Texas&quot;)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-7-1.png" width="50%" /></p>
</div>
</div>
<div id="using-percent-formats" class="section level2">
<h2>Using percent formats</h2>
<p>It’s often the case that you want plot data with percentage changes. We can use darklyplot’s <code>labelx</code> parameter to format percents on the axis labels with <code>scales::percent</code>.</p>
<pre class="r"><code># compute monthly percent changes for Austin Texas
txhousing3 &lt;- txhousing[txhousing$city==&quot;Austin&quot;,]
txhousing3$date &lt;- as.Date(ISOdate(txhousing3$year, txhousing3$month,1))
txhousing3$dsales &lt;- (txhousing3$sales/lag(txhousing3$sales,12) -1 )
txhousing3 &lt;- txhousing3[!is.na(txhousing3$dsales),]

darklyplot(df=txhousing3,column=&quot;dsales&quot;,
           refline=TRUE,
           labelx=&quot;percent&quot;,
           #n.decimals corresponds to accuracy in scales::percent when labelx=&quot;percent&quot;
           n.decimals=.1)+
  labs(title=&quot;12-month perent change home sales in Austin, Texas&quot;)</code></pre>
<p><img src="/post/2020-07-03-using-darklyplot_files/figure-html/vignette-8-1.png" width="50%" /></p>
</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://lenkiefer.com/2020/07/02/a-new-r-package-darklyplot/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://lenkiefer.com/2020/07/02/a-new-r-package-darklyplot/">A new R package darklyplot</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://lenkiefer.com/2020/09/22/dcasting-a-data-table/">dcasting a data table</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://lenkiefer.com/2020/09/22/dcasting-a-data-table/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>
<footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/r/">R</a>, 
            
                <a href="/tags/dataviz/">dataviz</a>
            
        </p>
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?url=http://lenkiefer.comhttp%3a%2f%2flenkiefer.com%2f2020%2f07%2f03%2fusing-darklyplot%2f&text=Using%20darklyplot via %40lenkiefer"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://lenkiefer.comhttp%3a%2f%2flenkiefer.com%2f2020%2f07%2f03%2fusing-darklyplot%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        


        
    </div>
</footer>
</div>
</div>
<script src="http://lenkiefer.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66905937-1', 'auto');
  ga('send', 'pageview');

</script>






</body>
</html>

