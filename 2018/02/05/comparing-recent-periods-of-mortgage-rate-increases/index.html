<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="In this post we compare recent periods of mortgage rate increases. We&#39;ll remix a chart and try out some alternatives to visualize periods of rising rates.">
  <meta name="generator" content="Hugo 0.27.1" />

  <title>Comparing recent periods of mortgage rate increases &middot; Len Kiefer</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.PNG" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">Len Kiefer</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Archive</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/@lenkiefer" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/leonard-kiefer-51175331" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/lenkiefer" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2015-2018. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


       <meta name="twitter:card" content="summary_large_image">
       <meta name="twitter:image" content="http://lenkiefer.com//img/charts_feb_05_2018/mtg_rate_compare.png" >
     
    <meta property="og:title" content="Comparing recent periods of mortgage rate increases">
    <meta property="og:description" content="In this post we compare recent periods of mortgage rate increases. We&#39;ll remix a chart and try out some alternatives to visualize periods of rising rates.">

<div class="header">
  <h1>Comparing recent periods of mortgage rate increases</h1>
  <h2>In this post we compare recent periods of mortgage rate increases. We&#39;ll remix a chart and try out some alternatives to visualize periods of rising rates.</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2018/02/05</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/dataviz">dataviz</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/remix">remix</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/r">R</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/mortgage">mortgage</a>
    
  </div>
  
  

</div>

  <p>THIS MORNING I SAW AN INTERESTING CHART OVER ON BLOOMBERG. In <a href="https://www.bloomberg.com/news/articles/2018-02-05/rational-inexuberance-in-the-bond-market">this post</a> they compared recent 10-year Treasury yield movements with the Taper Tantrum in 2013. The chart <a href="https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iQxqvfm5AhYQ/v0/-1x-1.png">you can see here</a> was an area chart with overlapping line plots.</p>
<p>I thought it would be a fun exercise to remix a similar chart with <a href="https://www.r-project.org/">R</a>.</p>
<p>Eventually it will look like this:</p>
<p><img src="../../../../img/charts_feb_05_2018/mtg_rate_compare.png"></p>
<p>Let’s make our remix and try out a few alternative plots.</p>
<div id="get-data" class="section level1">
<h1>Get data</h1>
<p>Following our <a href="../../../../2017/10/19/mortgage-rates-are-low/">Mortgage rates are low!</a> post we will use <a href="https://CRAN.R-project.org/package=quantmod">quantmod</a> and <a href="https://CRAN.R-project.org/package=tidyquant">tidyquant</a> to get mortgage rate data via the St. Louis Federal Reserve Economic Database <a href="https://fred.stlouisfed.org/">FRED</a>.</p>
<p>For more on tidyquant also check out <a href="../../../../2017/09/18/a-tidyquant-um-of-solace/">my tidyquantum of solace</a>.</p>
<pre class="r"><code>#####################################################################################
## Load libraries ##
#####################################################################################
library(tidyverse)
library(readxl)
library(tidyquant)
library(tibbletime)
library(ggridges)
library(viridis)
library(cowplot)
library(ggbeeswarm)</code></pre>
<pre class="r"><code>#####################################################################################
## Get mortgage data ##
# Can also get direct here: http://www.freddiemac.com/pmms/docs/historicalweeklydata.xls
#####################################################################################

tickers&lt;-c(&quot;MORTGAGE30US&quot;)


df&lt;-tq_get(tickers,get=&quot;economic.data&quot;,from=&quot;2000-01-01&quot;)

# download data via FRED 
df&lt;-tq_get(tickers,                         # get selected symbols
            get=&quot;economic.data&quot;,             # use FRED
            from=&quot;2012-01-01&quot;)               # go from 2007 forward</code></pre>
<p>Now that we have the data we can identify periods of rapid rate increases. I tried some algorithmic approaches (like with <code>quantmod::findPeaks</code>) but the pattern is clear enough that “eyeball econometrics” can work here.</p>
<pre class="r"><code>df.1 &lt;- filter(df, date&gt;=&quot;2013-05-02&quot; &amp;  date &lt;= &quot;2013-09-12&quot;) %&gt;%
  mutate(period=&quot;Taper Tantrum 2013&quot;, id=row_number())

df.2 &lt;- filter(df, date&gt;=&quot;2016-10-27&quot; &amp;  date &lt;= &quot;2017-03-16&quot;) %&gt;%
  mutate(period=&quot;US Election 2016&quot;, id=row_number())

df.3 &lt;- filter(df, date&gt;=&quot;2017-09-14&quot; &amp;  date &lt;= &quot;2018-03-31&quot;) %&gt;%
  mutate(period=&quot;Recent Period&quot;, id=row_number())

df.note&lt;- data.frame( date=as.Date(c(&quot;2013-05-02&quot;,&quot;2016-10-27&quot;,&quot;2017-09-14&quot;)),
                      period=c(&quot;Taper Tantrum 2013&quot;, &quot;US Election 2016&quot;,&quot;Recent Period&quot;),
                      end.date=as.Date(c(&quot;2013-09-12&quot;,&quot;2017-03-16&quot;,&quot;2018-02-01&quot;)))

df2&lt;- bind_rows(df.1,df.2,df.3)
df2&lt;-df2 %&gt;% mutate(periodf=factor(period, levels=c(&quot;Taper Tantrum 2013&quot;, &quot;US Election 2016&quot;,&quot;Recent Period&quot;)))

df.note1&lt;-left_join(df.note, df2 %&gt;% select(date,price, id, periodf), by=&quot;date&quot;)
df.note1&lt;- left_join(df.note1, df2 %&gt;% select(date,price,id), by=c(&quot;end.date&quot;=&quot;date&quot;))

# plot with annotations
g1&lt;-
  ggplot(data=df2, aes(x=id,y=price, color=periodf,fill=periodf))+
  geom_ribbon(aes(ymin=3.3,ymax=price),color=NA,alpha=0.2)+
  geom_line(size=1.1)+
  scale_fill_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  scale_color_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  theme_minimal()+
  scale_x_continuous(expand=c(0,0),limits=c(1,23))+
  scale_y_continuous(limits=c(3.3,4.7),breaks=seq(3.3,4.7,.2),sec.axis=dup_axis())+
  labs(x=&quot;weeks since rates started rising&quot;,y=&quot;30-year fixed mortgage rates (%)&quot;,
       title=&quot;Recent periods of mortgage rate increases&quot;,
       subtitle=&quot;U.S. weekly average 30-year fixed mortgage rates (%)&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey through February 1, 2018&quot;)+
  ggrepel::geom_label_repel(data=df.note1, inherit.aes=F, fontface=&quot;bold&quot;,size=3,
                            aes(x=id.y,color=periodf, label=period,y=price.y))+
  ggrepel::geom_label_repel(data=df.note1, inherit.aes=F, fontface=&quot;bold&quot;,size=3,
                            aes(x=id.x,color=periodf, label=paste0(&quot;Began: &quot;,as.character(date,format=&quot;%b %d,%Y&quot;)),y=price.x))+
  theme(plot.caption=element_text(hjust=0),legend.position=&quot;none&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18),
        plot.subtitle=element_text(face=&quot;italic&quot;,size=14),
        strip.text=element_text(face=&quot;bold&quot;,size=14))

g1 # print plot</code></pre>
<p><img src="/post/2018-02-05-comparing-recent-periods-of-mortgage-rate-increases_files/figure-html/02-05-2018-plot-1-1.png" width="672" /></p>
<p>This plot compare overlapping time periods. The x axis displays weeks from a starting week. For example, the week of September 14, 2017 is 1 for the Recent Period Line. I mimicked the style of the Bloomberg plot using shaded area with alpha transparencies. The Bloomberg plot only had two periods, so the comparison was easier. Still, I think we can glean something from this plot. Adding a fourth line would probably be too much. I explore a small multiple version below.</p>
<p>Two things to note from this plot. First, the rate of increase in rates is much less (so far) in the Recent Period. The Recent Period began from a higher starting point but (so far) hasn’t passed the endpoints of the other periods.</p>
<p>To help understand the plot, let’s consider a more traditional plot.</p>
<pre class="r"><code>g2&lt;-
ggplot(data=df, aes(x=date,y=price))+
  geom_line(color=&quot;darkgray&quot;,inherit.aes=F,aes(x=date,y=price))+
  theme_minimal()+
  scale_y_continuous(limits=c(3.3,4.7),breaks=seq(3.3,4.7,.2),sec.axis=dup_axis())+
    scale_fill_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  scale_color_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  labs(x=&quot;&quot;,y=&quot;30-year fixed mortgage rates (%)&quot;,
       title=&quot;Recent periods of mortgage rate increases&quot;,
       subtitle=&quot;U.S. weekly average 30-year fixed mortgage rates (%)&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey through February 1, 2018&quot;)+
  theme(plot.caption=element_text(hjust=0),legend.position=&quot;none&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18),
        plot.subtitle=element_text(face=&quot;italic&quot;,size=14),
        strip.text=element_text(face=&quot;bold&quot;,size=14))
g2</code></pre>
<p><img src="/post/2018-02-05-comparing-recent-periods-of-mortgage-rate-increases_files/figure-html/02-05-2018-plot-2-1.png" width="672" /></p>
<p>This plot is a standard time series plot. Eyeball econometrics can pick out three periods of rate increases since 2012. Let’s highlight them:</p>
<pre class="r"><code>g3&lt;-
ggplot(data=df2, aes(x=date,y=price, color=periodf,fill=periodf))+
  geom_line(data=df %&gt;% mutate(id=row_number()),color=&quot;darkgray&quot;,inherit.aes=F,aes(x=date,y=price))+
  geom_ribbon(aes(ymin=3.3,ymax=price),color=NA,alpha=0.2)+
  geom_line(size=1.1)+
  scale_fill_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  scale_color_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  theme_minimal()+
 geom_label(data=df.note1, inherit.aes=F, fontface=&quot;bold&quot;,size=3,
                              aes(x=end.date,color=periodf, label=period,y=price.y),hjust=1,nudge_y=0.05)+
  scale_y_continuous(limits=c(3.3,4.7),breaks=seq(3.3,4.7,.2),sec.axis=dup_axis())+
  labs(x=&quot;&quot;,y=&quot;30-year fixed mortgage rates (%)&quot;,
       title=&quot;Recent periods of mortgage rate increases&quot;,
       subtitle=&quot;U.S. weekly average 30-year fixed mortgage rates (%)&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey through February 1, 2018&quot;)+
  theme(plot.caption=element_text(hjust=0),legend.position=&quot;none&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18),
        plot.subtitle=element_text(face=&quot;italic&quot;,size=14),
        strip.text=element_text(face=&quot;bold&quot;,size=14))
g3</code></pre>
<p><img src="/post/2018-02-05-comparing-recent-periods-of-mortgage-rate-increases_files/figure-html/02-05-2018-plot-3-1.png" width="672" /></p>
<p>I’ve gone ahead and labeled the three periods. The Taper Tantrum corresponds to the period over the spring of 2013. Following the U.S. election in November of 2016 rates also increased. And finally, we have the recent increase in rates.</p>
<p>Next, let’s drop the gray periods and use a small multiple to compare the periods.</p>
<pre class="r"><code>g4&lt;-
  ggplot(data=df2, aes(x=id,y=price, color=periodf,fill=periodf))+
  geom_ribbon(aes(ymin=3.3,ymax=price),color=NA,alpha=0.2)+
  geom_line(size=1.1)+
  scale_fill_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  scale_color_viridis(option=&quot;D&quot;,discrete=T,end=0.85)+
  theme_minimal()+
  scale_x_continuous(expand=c(0,0),limits=c(1,23))+
  ggrepel::geom_label_repel(data=df.note1, inherit.aes=F, fontface=&quot;bold&quot;,size=3,
                            aes(x=id.y,color=periodf, label=paste0(as.character(end.date,format=&quot;%b %d,%Y&quot;),&quot;: &quot;,price.y),y=price.y))+
  ggrepel::geom_label_repel(data=df.note1, inherit.aes=F, fontface=&quot;bold&quot;,size=3,
                            aes(x=id.x,color=periodf, label=paste0(as.character(date,format=&quot;%b %d,%Y&quot;),&quot;: &quot;,price.x),y=price.x))+
  scale_y_continuous(limits=c(3.3,4.7),breaks=seq(3.3,4.7,.2),sec.axis=dup_axis())+
  labs(x=&quot;weeks since rates started rising&quot;,y=&quot;30-year fixed mortgage rates (%)&quot;,
       title=&quot;Recent periods of mortgage rate increases&quot;,
       subtitle=&quot;U.S. weekly average 30-year fixed mortgage rates (%)&quot;,
       caption=&quot;@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey through February 1, 2018&quot;)+
  theme(plot.caption=element_text(hjust=0),legend.position=&quot;none&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18),
        plot.subtitle=element_text(face=&quot;italic&quot;,size=14),
        strip.text=element_text(face=&quot;bold&quot;,size=14))+
  facet_wrap(~periodf)

g4</code></pre>
<p><img src="/post/2018-02-05-comparing-recent-periods-of-mortgage-rate-increases_files/figure-html/02-05-2018-plot-4-1.png" width="672" /></p>
<pre class="r"><code>#cowplot::plot_grid(g2,g3,ncol=1)</code></pre>
<p>Finally, we could use <a href="https://CRAN.R-project.org/package=cowplot">cowplot</a>’s plot_grid() function to arrange multiple plots into a panel.</p>
<pre class="r"><code>cowplot::plot_grid(g1+labs(caption=&quot;&quot;), # remove caption
                   g4+theme(plot.title=element_blank(), plot.subtitle=element_blank()),
                   ncol=1)</code></pre>
<p><img src="/post/2018-02-05-comparing-recent-periods-of-mortgage-rate-increases_files/figure-html/02-05-2018-plot-5-1.png" width="672" /></p>
<div id="new-colors" class="section level2">
<h2>New colors</h2>
<p>I really like the <a href="https://CRAN.R-project.org/package=viridis">viridis</a> package. It’s just been updated with a new color map: cividis. Let’s redraw the compositie plot using the cividis color map (option “E” in the <code>scale_color_viridis</code> function call).</p>
<pre class="r"><code>cowplot::plot_grid(g1+labs(caption=&quot;&quot;)+ # remove caption   
                     scale_fill_viridis(option=&quot;E&quot;,discrete=T,end=0.85)+ # use cividis color map
                     scale_color_viridis(option=&quot;E&quot;,discrete=T,end=0.85),
                   g4+theme(plot.title=element_blank(), plot.subtitle=element_blank())+
                     scale_fill_viridis(option=&quot;E&quot;,discrete=T,end=0.85)+ # use cividis color map
                     scale_color_viridis(option=&quot;E&quot;,discrete=T,end=0.85),
                   ncol=1)</code></pre>
<p><img src="/post/2018-02-05-comparing-recent-periods-of-mortgage-rate-increases_files/figure-html/02-05-2018-plot-6-1.png" width="672" /></p>
</div>
</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/2018/01/23/me-on-a-podcast/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/2018/01/23/me-on-a-podcast/">Me on a podcast</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/2018/02/07/february-2018-housing-market-update/">February 2018 housing market update </a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/2018/02/07/february-2018-housing-market-update/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>
<footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/dataviz/">dataviz</a>, 
            
                <a href="/tags/remix/">remix</a>, 
            
                <a href="/tags/r/">R</a>, 
            
                <a href="/tags/mortgage/">mortgage</a>
            
        </p>
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?url=http://lenkiefer.com%2f2018%2f02%2f05%2fcomparing-recent-periods-of-mortgage-rate-increases%2f&text=Comparing%20recent%20periods%20of%20mortgage%20rate%20increases via %40lenkiefer"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://lenkiefer.com%2f2018%2f02%2f05%2fcomparing-recent-periods-of-mortgage-rate-increases%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        


        
    </div>
</footer>
</div>
</div>
<script src="/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66905937-1', 'auto');
  ga('send', 'pageview');

</script>






</body>
</html>

