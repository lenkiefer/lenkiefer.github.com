<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.81.0" />

  <title>Industry-specific Beveridge Curves &middot; Len Kiefer</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://lenkiefer.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://lenkiefer.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://lenkiefer.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://lenkiefer.com/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="http://lenkiefer.com/">Len Kiefer</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/post/"><i class='fa fa-list fa-fw'></i>Archive</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/@lenkiefer" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/leonard-kiefer-51175331" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/lenkiefer" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2021. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


       <meta name="twitter:card" content="summary">
       <meta name="twitter:image" content="http://lenkiefer.com/img/logo/logo.png" >
    
    <meta property="og:title" content="Industry-specific Beveridge Curves">
    <meta property="og:description" content="IN MY PREVIOUS POST we looked at the Job Openings and Labor Turnover Survey (JOLTS) data and plotted a Beveridge Curve. In this post I want to add some more code that allows us to plot Beveridge Curves by industry.
For more on the analysis of industry-specific Beveridge Curves, see this paper published in the June 2012 Monthly Labor Review that decomposes shifts in the Beveridge Curve and looks at it by industry.">

<div class="header">
  <h1>Industry-specific Beveridge Curves</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2016/09/14</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/dataviz">dataviz</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/economy">economy</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/r">R</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/animation">animation</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://lenkiefer.com/tags/data-wrangling">data wrangling</a>
    
  </div>
  
  

</div>

  <p>IN MY <a href="../../../../2016/09/10/job-openings-and-hires">PREVIOUS POST</a> we looked at the <a href="http://www.bls.gov/jlt/home.htm">Job Openings and Labor Turnover Survey (JOLTS)</a> data and plotted a <a href="https://en.wikipedia.org/wiki/Beveridge_curve">Beveridge Curve</a>. In this post I want to add some more code that allows us to plot Beveridge Curves by industry.</p>
<p>For more on the analysis of industry-specific Beveridge Curves, see <a href="http://www.bls.gov/opub/mlr/2012/06/art2full.pdf">this paper</a> published in the June 2012 <a href="http://www.bls.gov/opub/mlr/about.htm">Monthly Labor Review</a> that decomposes shifts in the Beveridge Curve and looks at it by industry. Analyzing data through March 2012, the authors found that Construction alone shifted the total market Beveridge Curve by a full percentage point (see Table 4 in the paper).</p>
<h2 id="the-data">The data</h2>
<p>While the data is all available from the Bureau of Labor Statistics (BLS) <a href="bls.gov">webpage</a> it required some looking through the available files to find the right series. In the handy code I post below, we can grab the right data from BLS and produce our plots.</p>
<p>We&rsquo;re going to pull our data from two sources, the JOLTS data, and the <a href="http://www.bls.gov/cps/">Current Population Survey (CPS)</a>.  You can access flat files from BLS <a href="http://download.bls.gov/pub/time.series/jt/">here for JOLTS</a> and <a href="http://download.bls.gov/pub/time.series/ln/">here for CPS</a>. Unfortunately the industry codes available in the flat files are not identical, but I hunted down (what I think are) the proper codes and combined them.  You can read more <a href="http://www.bls.gov/cps/cpsoccind.htm">here</a>.</p>
<p>The relevant passages are quoted below</p>
<h3 id="jolts">JOLTS</h3>
<blockquote>
<p>The Job Openings and Labor Turnover Survey (JOLTS) publishes industry estimates based on the 2012 North American Industry Classification System (NAICS). NAICS-based estimates are available for December 2000 to the present</p>
</blockquote>
<h3 id="cps">CPS</h3>
<blockquote>
<p>The Current Population Survey currently uses the 2010 Census occupational classification and, beginning with data for January 2014, the 2012 Census industry classification. These classifications were derived from the 2010 Standard Occupational Classification (SOC) and the 2012 North American Industry Classification System (NAICS), respectively, to meet the special classification needs of demographic household surveys. The Census classifications use the same basic structure as the SOC and NAICS, but are generally less detailed.</p>
</blockquote>
<p>A crosswalk between the codes are available <a href="http://www.bls.gov/cps/cenind2012.htm">here</a>. For example, construction has the Census code 0770 while the corresponding NAICS code is 23.</p>
<p>I&rsquo;m going to rely on the fact that the industry names are identical in the BLS data and merge on the industry names rather than use the crosswalk. You can confirm this works by comparing <a href="http://www.bls.gov/news.release/jolts.t01.htm">this table</a> for JOLTS to <a href="http://www.bls.gov/news.release/empsit.t14.htm">this table</a> for the unemployment rate from CPS.</p>
<h3 id="setup-files">Setup files</h3>
<p>The code below merges the industry names and codes for JOLTS to (the same) industry name and (different) codes for CPS.</p>
<p>{% highlight r</p>
<h1 id="load-libraries">load libraries</h1>
<p>library(ggplot2)
library(animation)
library(stringr)
library(data.table)
library(tweenr)
library(purrr)
library(dplyr)
library(viridis)</p>
<p>#get CPS codes</p>
<h1 id="these-are-the-major-sectors-in-bls-table-14-httpwwwblsgovnewsreleaseempsitt14htm">These are the major sectors in BLS table 14: <a href="http://www.bls.gov/news.release/empsit.t14.htm">http://www.bls.gov/news.release/empsit.t14.htm</a></h1>
<p>#i saved these in a .txt file called incodelu.txt</p>
<p>#indy_code	indy_text</p>
<h1 id="0000all-industries">0000	All Industries</h1>
<h1 id="0169agriculture-forestry-fishing-and-hunting">0169	Agriculture, forestry, fishing, and hunting</h1>
<h1 id="0368nonagriculture-industries">0368	Nonagriculture industries</h1>
<h1 id="0369mining-quarrying-and-oil-and-gas-extraction">0369	Mining, quarrying, and oil and gas extraction</h1>
<h1 id="0569utilities">0569	Utilities</h1>
<h1 id="0770construction">0770	Construction</h1>
<h1 id="1068nondurable-goods-manufacturing">1068	Nondurable goods manufacturing</h1>
<h1 id="2467manufacturing">2467	Manufacturing</h1>
<h1 id="2468durable-goods-manufacturing">2468	Durable goods manufacturing</h1>
<h1 id="4067wholesale-and-retail-trade">4067	Wholesale and retail trade</h1>
<h1 id="4068wholesale-trade">4068	Wholesale trade</h1>
<h1 id="4669retail-trade">4669	Retail trade</h1>
<h1 id="6068transportation-and-utilities">6068	Transportation and utilities</h1>
<h1 id="6069transportation-and-warehousing">6069	Transportation and warehousing</h1>
<h1 id="6468information">6468	Information</h1>
<h1 id="6469publishing-except-internet">6469	Publishing, except Internet</h1>
<h1 id="6569motion-pictures-and-sound-recording-industries">6569	Motion pictures and sound recording industries</h1>
<h1 id="6670radio-and-television-broadcasting-and-cable-subscriptions-programming">6670	Radio and television broadcasting and cable subscriptions programming</h1>
<h1 id="6679telecommunications">6679	Telecommunications</h1>
<h1 id="6769other-information-services">6769	Other information services</h1>
<h1 id="6867financial-activities">6867	Financial activities</h1>
<h1 id="6868finance-and-insurance">6868	Finance and insurance</h1>
<h1 id="6869finance">6869	Finance</h1>
<h1 id="6990insurance-carriers-and-related-activities">6990	Insurance carriers and related activities</h1>
<h1 id="7069real-estate-and-rental-and-leasing">7069	Real estate and rental and leasing</h1>
<h1 id="7268professional-and-business-services">7268	Professional and business services</h1>
<h1 id="7269professional-and-technical-services">7269	Professional and technical services</h1>
<h1 id="7569management-administrative-and-waste-services">7569	Management, administrative, and waste services</h1>
<h1 id="7858education-and-health-services">7858	Education and health services</h1>
<h1 id="7859educational-services">7859	Educational services</h1>
<h1 id="7968health-care-and-social-assistance">7968	Health care and social assistance</h1>
<h1 id="8558leisure-and-hospitality">8558	Leisure and hospitality</h1>
<h1 id="8559arts-entertainment-and-recreation">8559	Arts, entertainment, and recreation</h1>
<h1 id="8658accommodation-and-food-services">8658	Accommodation and food services</h1>
<h1 id="8659accommodation">8659	Accommodation</h1>
<h1 id="8679food-services-and-drinking-places">8679	Food services and drinking places</h1>
<h1 id="8767other-services">8767	Other services</h1>
<h1 id="8768other-services-except-private-households">8768	Other services, except private households</h1>
<h1 id="9290other-services-private-households">9290	Other services, private households</h1>
<p>#read file:
my.indy&lt;-fread(&ldquo;data/indcodeslu.txt&rdquo;)</p>
<p>#Get JOLTS codes 
#saved in a file  indcodesjolts.txt</p>
<h1 id="industry_codeindustry_textdisplay_levelselectablesort_sequenceblank">industry_code	industry_text	display_level	selectable	sort_sequence	blank</h1>
<h1 id="000000total-nonfarm0t1">000000	Total nonfarm	0	T	1</h1>
<h1 id="100000total-private1t2">100000	Total private	1	T	2</h1>
<h1 id="110099mining-and-logging2t3">110099	Mining and logging	2	T	3</h1>
<h1 id="230000construction2t4">230000	Construction	2	T	4</h1>
<h1 id="300000manufacturing2t5">300000	Manufacturing	2	T	5</h1>
<h1 id="320000durable-goods-manufacturing3t6">320000	Durable goods manufacturing	3	T	6</h1>
<h1 id="340000nondurable-goods-manufacturing3t7">340000	Nondurable goods manufacturing	3	T	7</h1>
<h1 id="400000trade-transportation-and-utilities2t8">400000	Trade, transportation, and utilities	2	T	8</h1>
<h1 id="420000wholesale-trade3t9">420000	Wholesale trade	3	T	9</h1>
<h1 id="440000retail-trade3t10">440000	Retail trade	3	T	10</h1>
<h1 id="480099transportation-warehousing-and-utilities3t11">480099	Transportation, warehousing, and utilities	3	T	11</h1>
<h1 id="510000information2t12">510000	Information	2	T	12</h1>
<h1 id="510099financial-activities2t13">510099	Financial activities	2	T	13</h1>
<h1 id="520000finance-and-insurance3t14">520000	Finance and insurance	3	T	14</h1>
<h1 id="530000real-estate-and-rental-and-leasing3t15">530000	Real estate and rental and leasing	3	T	15</h1>
<h1 id="540099professional-and-business-services2t16">540099	Professional and business services	2	T	16</h1>
<h1 id="600000education-and-health-services2t17">600000	Education and health services	2	T	17</h1>
<h1 id="610000educational-services3t18">610000	Educational services	3	T	18</h1>
<h1 id="620000health-care-and-social-assistance3t19">620000	Health care and social assistance	3	T	19</h1>
<h1 id="700000leisure-and-hospitality2t20">700000	Leisure and hospitality	2	T	20</h1>
<h1 id="710000arts-entertainment-and-recreation3t21">710000	Arts, entertainment, and recreation	3	T	21</h1>
<h1 id="720000accommodation-and-food-services3t22">720000	Accommodation and food services	3	T	22</h1>
<h1 id="810000other-services2t23">810000	Other services	2	T	23</h1>
<h1 id="900000government1t24">900000	Government	1	T	24</h1>
<h1 id="910000federal2t25">910000	Federal	2	T	25</h1>
<h1 id="920000state-and-local2t26">920000	State and local	2	T	26</h1>
<h1 id="923000state-and-local-government-education3t27">923000	State and local government education	3	T	27</h1>
<h1 id="929000state-and-local-government-excluding-education3t28">929000	State and local government, excluding education	3	T	28</h1>
<p>my.indy2&lt;-fread(&ldquo;data/indcodesjolts.txt&rdquo;)</p>
<p>#merge together industry names
my.indy3&lt;-merge(my.indy2,my.indy,by.x=&ldquo;industry_text&rdquo;,by.y=&ldquo;indy_text&rdquo;)
{% endhighlight</p>
<h3 id="prepare-data">Prepare data</h3>
<p>Now that we have the codes we can read the data from the BLS and use the industry codes to merge the data.</p>
<p>{% highlight r</p>
<h1 id="read-in-unemployment-rated">read in unemployment rated</h1>
<p>ln.series&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/ln/ln.series%22">http://download.bls.gov/pub/time.series/ln/ln.series&quot;</a>)
ln.data&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/ln/ln.data.1.AllData%22">http://download.bls.gov/pub/time.series/ln/ln.data.1.AllData&quot;</a>)
ln.indy&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/ln/ln.indy%22">http://download.bls.gov/pub/time.series/ln/ln.indy&quot;</a>)</p>
<h1 id="find-series-named-unemployment-rate">find series named unemployment rate:</h1>
<p>my.series&lt;-ln.series[grepl(&ldquo;Unemployment Rate&rdquo;,series_title) &amp; indy_code !=0,]
my.series&lt;-ln.series[(grepl(&ldquo;Unemployment Rate&rdquo;,series_title) &amp; indy_code !=0 &amp; indy_code %in% my.indy3$indy_code
&amp; ages_code==0 &amp; periodicity_code==&ldquo;M&rdquo; &amp;  sexs_code==0) | series_id==&ldquo;LNU04000000&rdquo;,]</p>
<p>ln.data2&lt;-ln.data[year&gt;1999 &amp; series_id %in% my.series$series_id,]
ln.data2&lt;-merge(ln.data2,my.series[,list(series_id,indy_code)],by=&ldquo;series_id&rdquo;,all.x=T)
ln.data2 &lt;-merge(ln.data2,my.indy3[,list(indy_code,industry_text),],by=&ldquo;indy_code&rdquo;,all.x=T)
ln.data2&lt;-dplyr::rename(ln.data2,ur=value)</p>
<p>#get jolts data</p>
<p>jolts.dt&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/jt/jt.data.1.AllItems%22">http://download.bls.gov/pub/time.series/jt/jt.data.1.AllItems&quot;</a>)
jolts.series&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/jt/jt.series%22">http://download.bls.gov/pub/time.series/jt/jt.series&quot;</a>)
jolts.ind&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/jt/jt.industry%22,">http://download.bls.gov/pub/time.series/jt/jt.industry&quot;,</a>
col.names=c(&ldquo;industry_code&rdquo;,&ldquo;industry_text&rdquo;,	&ldquo;display_level&rdquo;,	&ldquo;selectable&rdquo;,&ldquo;sort_sequence&rdquo;,&ldquo;blank&rdquo;))
jolts.element&lt;-fread(&ldquo;<a href="http://download.bls.gov/pub/time.series/jt/jt.dataelement%22,">http://download.bls.gov/pub/time.series/jt/jt.dataelement&quot;,</a>
col.names=c(&ldquo;dataelement_code&rdquo;,&ldquo;dataelement_text&rdquo;,&ldquo;display_level&rdquo;,&ldquo;selectable&rdquo;,&ldquo;sort_sequence&rdquo;,&ldquo;blank&rdquo;                     ))</p>
<p>#we want job openeings: dataelement=JO, not seasonally adjusted, rates (ratelevel_code=R) and U.S. (region_code=00)</p>
<h1 id="we-also-want-the-aggregate-series-whos-id-is-jtu00000000jor-i-found-it-manually">we also want the aggregate series, whos id is JTU00000000JOR (I found it manually)</h1>
<p>my.series&lt;-jolts.series[( industry_code %in% my.indy3$industry_code &amp; 
dataelement_code==&ldquo;JO&rdquo; &amp;
seasonal==&ldquo;U&rdquo;  &amp; ratelevel_code==&ldquo;R&rdquo; &amp; region_code==&ldquo;00&rdquo;) | series_id==&ldquo;JTU00000000JOR&rdquo;, ]</p>
<p>jolts.dt2&lt;-jolts.dt[series_id %in% my.series$series_id,]
jolts.dt2&lt;-merge(jolts.dt2,my.series[,list(series_id,industry_code),],by=&ldquo;series_id&rdquo;)
jolts.dt2 &lt;-merge(jolts.dt2,my.indy3[,list(industry_code,industry_text),],by=&ldquo;industry_code&rdquo;,all.x=T)
jolts.dt2&lt;-dplyr::rename(jolts.dt2,jo=value)</p>
<p>all.dt&lt;-merge(ln.data2[,list(year,period,ur,industry_text,indy_code)],
jolts.dt2[,list(year,period,jo,industry_text,industry_code)],
by=c(&ldquo;year&rdquo;,&ldquo;period&rdquo;,&ldquo;industry_text&rdquo;))</p>
<h1 id="merge-data">merge data:</h1>
<p>all.dt$ur&lt;-as.numeric(all.dt$ur)
all.dt[industry_code==0,industry_text:=&ldquo;All Industries&rdquo;]
all.dt[,month:=as.numeric(substr(period,2,3))]
all.dt[,date:= as.Date(ISOdate(year,month,1))]</p>
<p>#We want to distinguish between recession and expansions using NBER recession dates</p>
<p>#Turning Point Date	Peak or Trough	Announcement Date with Link
#June 2009	Trough	September 20, 2010
#December 2007	Peak	December 1, 2008
#March 2001	Peak	November 26, 2001</p>
<p>#create recessions</p>
<p>all.dt[, recession:=&ldquo;Expansion&rdquo;]
all.dt[ (date&gt;&ldquo;2001-02-28&rdquo; &amp; date&lt;=&ldquo;2001-12-01&rdquo;) |
(date&gt;&ldquo;2007-10-31&rdquo; &amp; date&lt;=&ldquo;2009-06-30&rdquo;),
recession:=&ldquo;Recession&rdquo; ]
{% endhighlight</p>
<h3 id="check-data">Check Data</h3>
<p>Now we should have data in a format that we can use.</p>
<p>{% highlight r 
library(htmlTable) #make a table
htmlTable(all.dt[ date==&ldquo;2016-07-01&rdquo;, list(year,period,industry_text,indy_code,industry_code,ur,jo)], col.rgroup = c(&ldquo;none&rdquo;, &ldquo;#F7F7F7&rdquo;),caption=&ldquo;Merged Table&rdquo;,
header = c(&ldquo;Year &ldquo;,&ldquo;Period &ldquo;,&ldquo;industry&rdquo;,&ldquo;Industry\ncode (CPS)&rdquo;,&ldquo;Industry\ncode (JOLTS)&rdquo;,&ldquo;Unemployment\nRate &ldquo;,&ldquo;Job Openings\nRate&rdquo;),
tfoot=&ldquo;Source: U.S. Bureau of Labor Statistics\ndata are not seasonally adjusted&rdquo;)
{% endhighlight</p>
<!-- raw HTML omitted -->
<h3 id="create-panel-plot">Create Panel Plot</h3>
<p>Now we can create a panel plot.</p>
<p>{% highlight r</p>
<h1 id="turn-industry-text-into-factors-so-we-can-get-all-industries-in-first-position">turn industry text into factors so we can get All industries in first position</h1>
<p>all.dt$ind.textf&lt;-factor(all.dt$industry_text,levels=unique(all.dt$industry_text))</p>
<p>ggplot(data=all.dt,aes(x=ur,y=jo,color=recession))+geom_point(alpha=0.25)+facet_wrap(~ind.textf,ncol=4)+
theme_minimal()+
theme(plot.caption=element_text(hjust=0,size=7))+
#put the legend down at the bottom right
theme(legend.position = c(0.85, 0.075) )+
#Let&rsquo;s circle the last available point:
geom_point(data=all.dt[ date==&ldquo;2016-07-01&rdquo;],shape=21,size=3,color=viridis(3)[1])+
geom_text(data=all.dt[  date==&ldquo;2016-07-01&rdquo;],size=2,color=viridis(3)[1],label=&ldquo;July, 2016\n\n&rdquo;)+
theme(strip.text.x = element_text(size = 7))+
scale_color_manual(name=&ldquo;Recession or\nExpansion&rdquo;,values=c(viridis(5)[4],magma(5)[3]))+
labs(x=&ldquo;Unemployment Rate (%, NSA)&quot;,y=&ldquo;Job Openings Rate (%, NSA)&rdquo;,
title=&ldquo;The Beveridge Curve&rdquo;,
subtitle=&ldquo;job openings rate vs unemployment rate (NSA)&rdquo;,
caption=&quot;@lenkiefer Source: U.S. Bureau of Labor Statistics, Current Population Survey and Job Openings and Labor Turnover Survey&rdquo;)
{% endhighlight</p>
<p><img src="http://lenkiefer.com/img/Rfig/fig-bv-grahp1-1.svg" alt="plot of chunk fig-bv-grahp1"></p>
<h3 id="add-animation">Add animation</h3>
<p>If we wish, we can add animation through the following code.</p>
<p><em>See my earlier <a href="../../../../2016/05/29/improving-R-animated-gifs-with-tweenr">post about tweenr</a> for an introduction to tweenr, and more examples <a href="../../../../2016/05/30/more-tweenr-animations">here</a> and <a href="../../../../2016/06/26/week-in-review">here</a>.</em></p>
<p>{% highlight r 
#make a function to prepare data for tweening
myf&lt;-function(m){
DT&lt;-copy(all.dt)
DT&lt;-DT[industry_text==m,]
DT %&gt;% map_if(is.character, as.factor) %&gt;% as.data.frame() -&gt;DT 
as.data.frame(DT)}</p>
<p>ind.list&lt;-unique(all.dt$industry_text) # get list of industries</p>
<p>#the animation will loop through each industry and return to All Industries (ind.list[1]).
my.list&lt;-lapply(c(ind.list,ind.list[1]),myf)</p>
<p>tf &lt;- tween_states(my.list, tweenlength= 2, statelength=3, ease=rep(&lsquo;cubic-in-out&rsquo;,17),nframes=300)
tf&lt;-data.table(tf)<br>
N&lt;-max(tf$.frame)</p>
<p>oopt = ani.options(interval = 0.2)
saveGIF({for (i in 1:N) {
g&lt;-
ggplot(data=tf[.frame==i,],aes(x=ur,y=jo,color=recession,group=recession))+geom_point(alpha=0.65)+facet_wrap(~industry_text)+
theme_minimal()+
theme(plot.caption=element_text(hjust=0,size=9))+
geom_point(data=tf[.frame==i &amp; date==&ldquo;2016-07-01&rdquo;],shape=21,size=3,color=viridis(3)[1])+
geom_text(data=tf[.frame==i &amp; date==&ldquo;2016-07-01&rdquo;],color=viridis(3)[1],label=&ldquo;July, 2016\n\n&rdquo;)+
coord_cartesian(ylim=c(0,8),xlim=c(0,28))+
theme(legend.position=&ldquo;bottom&rdquo;)+
scale_color_manual(name=&ldquo;Recession or Expansion&rdquo;,values=c(viridis(5)[4],magma(5)[3]))+
labs(x=&ldquo;Unemployment Rate (%, NSA)&quot;,y=&ldquo;Job Openings Rate (%, NSA)&rdquo;,
title=&ldquo;The Beveridge Curve&rdquo;,
subtitle=&ldquo;job openings rate vs unemployment rate (NSA)&rdquo;,
caption=&quot;@lenkiefer Source: U.S. Bureau of Labor Statistics, Current Population Survey and Job Openings and Labor Turnover Survey&rdquo;)</p>
<p>print(g)
ani.pause()
print(i) }
},movie.name=&ldquo;bv tween3.gif&rdquo;,ani.width = 650, ani.height = 500)
{% endhighlight</p>
<!-- raw HTML omitted -->

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flenkiefer.com%2f2016%2f09%2f14%2fbev-curves%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=http%3a%2f%2flenkiefer.com%2f2016%2f09%2f14%2fbev-curves%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=http%3a%2f%2flenkiefer.com%2f2016%2f09%2f14%2fbev-curves%2f" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=http%3a%2f%2flenkiefer.com%2f2016%2f09%2f14%2fbev-curves%2f" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2flenkiefer.com%2f2016%2f09%2f14%2fbev-curves%2f" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=http%3a%2f%2flenkiefer.com%2f2016%2f09%2f14%2fbev-curves%2f" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://lenkiefer.com/2016/09/10/job-openings-and-hires/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://lenkiefer.com/2016/09/10/job-openings-and-hires/">JOLTS! Job openings and labor turnover trends</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://lenkiefer.com/2016/09/22/week-in-gif/">Data visualizations for the week of September 22, 2016</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://lenkiefer.com/2016/09/22/week-in-gif/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="http://lenkiefer.com/js/ui.js"></script>
<script src="http://lenkiefer.com/js/menus.js"></script>




<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66905937-1', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="http://lenkiefer.com/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

