<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.81.0" />

  <title>A guide to building an interactive flexdashboard &middot; Len Kiefer</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://lenkiefer.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://lenkiefer.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://lenkiefer.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://lenkiefer.com/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="http://lenkiefer.com/">Len Kiefer</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/post/"><i class='fa fa-list fa-fw'></i>Archive</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://lenkiefer.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/@lenkiefer" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/leonard-kiefer-51175331" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/lenkiefer" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2021. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


       <meta name="twitter:card" content="summary">
       <meta name="twitter:image" content="http://lenkiefer.com/img/logo/logo.png" >
    
    <meta property="og:title" content="A guide to building an interactive flexdashboard">
    <meta property="og:description" content="R statistics dataviz remix flexdashboard">

<div class="header">
  <h1>A guide to building an interactive flexdashboard</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2017/01/22</time>
  </div>

  

  

  

</div>

  


<p>INTERACTIVE DASHBOARDS CAN BE AN EFFECTIVE WAY to explore and present data. Recently, I have been using <a href="http://rmarkdown.rstudio.com/flexdashboard/index.html">flexdashboards</a> created with <a href="https://www.r-project.org/">R</a>. Over January 2017 I’ve posted the following examples:</p>
<ul>
<li><p><a href="../../../../2017/01/08/mortgage-rate-viewer">Mortgage rates viewer</a></p></li>
<li><p><a href="../../../../2017/01/14/year-in-review-remix">Year in review remix</a></p></li>
<li><p><a href="../../../../2017/01/16/cross-talk-dashboard">Cross talk dashboard</a></p></li>
<li><p><a href="../../../../2017/01/20/flexin-friday">Flexin Friday</a></p></li>
</ul>
<p>For each of these you can get the code by clicking on the source link in the upper right corner of the visualizations at the respective links. While I tried to include helpful comments in the code it might be hard to build your own from scratch. While the <a href="http://rmarkdown.rstudio.com/flexdashboard/using.html">documentation</a> for flexdashboards is good and there are several examples in the <a href="http://rmarkdown.rstudio.com/flexdashboard/examples.html">gallery</a> you can learn from, I thought I’d take some time to walk through the construction of a new flexdashboard.</p>
<div id="the-plan" class="section level2">
<h2>The Plan</h2>
<p>We’ll build an interactive flexdashboard to explore trends in house prices across several areas. In this example I’m going to try to show you the following:</p>
<ul>
<li>How to set up a multipage dashboard -use a storyboard on one page</li>
<li>How to use <a href="https://plot.ly/r/">plotly</a> to create an interactive chart</li>
<li>How to combine plotly with <a href="https://github.com/rstudio/crosstalk">crosstalk</a> to add more interactions</li>
<li>How to animate a plotly chart</li>
</ul>
<div id="the-data" class="section level3">
<h3>The data</h3>
<p>For this project I’m going to revisit the house price data <a href="../../../../2016/05/08/visual-meditations-on-house-prices">we used in our house price meditations</a>. These house price data allow us to explore data that vary over both space and time, and that have interesting hierarchies we will explore.</p>
<p>While data wrangling is an important subject (see for example, <a href="(../../../../2016/05/08/visual-meditations-on-house-prices-part1%20)">this post on wrangling house price data</a>), I don’t want to distract from the dashboard. For this post, we’ll begin with our data compiled.</p>
<p>The data structure is fairly simple. We have columns corresponding to date, metro name, primary state for the metro area (the state of the metro’s principal city), Census region of the primary state <a href="https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf">(based on Census definitions)</a> the house price index, and the latitude and longitude of the principal city for the metro area. We’ve also computed the 12-month percent change in the house price index, named <em>hpa12</em>.</p>
<p>We’re using the <a href="http://www.freddiemac.com/finance/house_price_index.html">Freddie Mac House Price Index</a>.</p>
<p>I’ve arranged these data and saved them as a simple csv files.</p>
<ul>
<li>Metro hpi files <a href="../../../../chartbooks/jan2017/data/hpimetro.csv">hpimetro.csv</a></li>
<li>Stae house price file <a href="../../../../chartbooks/jan2017/data/hpistate.csv">hpistate.csv</a></li>
<li>National house price file <a href="../../../../chartbooks/jan2017/data/hpiusa.csv">hpiusa.csv</a></li>
</ul>
<p>Here’s how these data look (examining the metros):</p>
<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr><td colspan='9' style='text-align: left;'>
House Price Data</td></tr>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey;'> </th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>date</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>geo</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>statename</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>region</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>hpi</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>lat</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>long</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>hpa12</th>
</tr>
</thead>
<tbody>
<tr>
<td style='text-align: left;'>1</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Phoenix-Mesa-Scottsdale, AZ</td>
<td style='text-align: center;'>Arizona</td>
<td style='text-align: center;'>West Region</td>
<td style='text-align: center;'>177.31</td>
<td style='text-align: center;'>33.54</td>
<td style='text-align: center;'>-112.07</td>
<td style='text-align: center;'>0.06</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>2</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Los Angeles-Long Beach-Anaheim, CA</td>
<td style='background-color: #f7f7f7; text-align: center;'>California</td>
<td style='background-color: #f7f7f7; text-align: center;'>West Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>242.37</td>
<td style='background-color: #f7f7f7; text-align: center;'>34.11</td>
<td style='background-color: #f7f7f7; text-align: center;'>-118.41</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.07</td>
</tr>
<tr>
<td style='text-align: left;'>3</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Riverside-San Bernardino-Ontario, CA</td>
<td style='text-align: center;'>California</td>
<td style='text-align: center;'>West Region</td>
<td style='text-align: center;'>203.1</td>
<td style='text-align: center;'>33.94</td>
<td style='text-align: center;'>-117.4</td>
<td style='text-align: center;'>0.06</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>4</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sacramento--Roseville--Arden-Arcade, CA</td>
<td style='background-color: #f7f7f7; text-align: center;'>California</td>
<td style='background-color: #f7f7f7; text-align: center;'>West Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>184.01</td>
<td style='background-color: #f7f7f7; text-align: center;'>38.57</td>
<td style='background-color: #f7f7f7; text-align: center;'>-121.47</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.09</td>
</tr>
<tr>
<td style='text-align: left;'>5</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>San Diego-Carlsbad, CA</td>
<td style='text-align: center;'>California</td>
<td style='text-align: center;'>West Region</td>
<td style='text-align: center;'>207.68</td>
<td style='text-align: center;'>32.81</td>
<td style='text-align: center;'>-117.14</td>
<td style='text-align: center;'>0.08</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>6</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>San Francisco-Oakland-Hayward, CA</td>
<td style='background-color: #f7f7f7; text-align: center;'>California</td>
<td style='background-color: #f7f7f7; text-align: center;'>West Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>202.34</td>
<td style='background-color: #f7f7f7; text-align: center;'>37.77</td>
<td style='background-color: #f7f7f7; text-align: center;'>-122.45</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.09</td>
</tr>
<tr>
<td style='text-align: left;'>7</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Denver-Aurora-Lakewood, CO</td>
<td style='text-align: center;'>Colorado</td>
<td style='text-align: center;'>West Region</td>
<td style='text-align: center;'>181.02</td>
<td style='text-align: center;'>39.77</td>
<td style='text-align: center;'>-104.87</td>
<td style='text-align: center;'>0.11</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>8</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Washington-Arlington-Alexandria, DC-VA-MD-WV</td>
<td style='background-color: #f7f7f7; text-align: center;'>District of Columbia</td>
<td style='background-color: #f7f7f7; text-align: center;'>South Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>205.34</td>
<td style='background-color: #f7f7f7; text-align: center;'>38.91</td>
<td style='background-color: #f7f7f7; text-align: center;'>-77.02</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.03</td>
</tr>
<tr>
<td style='text-align: left;'>9</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Miami-Fort Lauderdale-West Palm Beach, FL</td>
<td style='text-align: center;'>Florida</td>
<td style='text-align: center;'>South Region</td>
<td style='text-align: center;'>215.97</td>
<td style='text-align: center;'>25.78</td>
<td style='text-align: center;'>-80.21</td>
<td style='text-align: center;'>0.1</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>10</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Orlando-Kissimmee-Sanford, FL</td>
<td style='background-color: #f7f7f7; text-align: center;'>Florida</td>
<td style='background-color: #f7f7f7; text-align: center;'>South Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>170.62</td>
<td style='background-color: #f7f7f7; text-align: center;'>28.5</td>
<td style='background-color: #f7f7f7; text-align: center;'>-81.37</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.1</td>
</tr>
<tr>
<td style='text-align: left;'>11</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Tampa-St. Petersburg-Clearwater, FL</td>
<td style='text-align: center;'>Florida</td>
<td style='text-align: center;'>South Region</td>
<td style='text-align: center;'>183.43</td>
<td style='text-align: center;'>27.96</td>
<td style='text-align: center;'>-82.48</td>
<td style='text-align: center;'>0.11</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>12</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Atlanta-Sandy Springs-Roswell, GA</td>
<td style='background-color: #f7f7f7; text-align: center;'>Georgia</td>
<td style='background-color: #f7f7f7; text-align: center;'>South Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>134.06</td>
<td style='background-color: #f7f7f7; text-align: center;'>33.76</td>
<td style='background-color: #f7f7f7; text-align: center;'>-84.42</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.08</td>
</tr>
<tr>
<td style='text-align: left;'>13</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Chicago-Naperville-Elgin, IL-IN-WI</td>
<td style='text-align: center;'>Illinois</td>
<td style='text-align: center;'>Midwest Region</td>
<td style='text-align: center;'>128.3</td>
<td style='text-align: center;'>41.84</td>
<td style='text-align: center;'>-87.68</td>
<td style='text-align: center;'>0.05</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>14</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Boston-Cambridge-Newton, MA-NH</td>
<td style='background-color: #f7f7f7; text-align: center;'>Massachusetts</td>
<td style='background-color: #f7f7f7; text-align: center;'>Northeast Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>162.05</td>
<td style='background-color: #f7f7f7; text-align: center;'>42.34</td>
<td style='background-color: #f7f7f7; text-align: center;'>-71.02</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.06</td>
</tr>
<tr>
<td style='text-align: left;'>15</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Baltimore-Columbia-Towson, MD</td>
<td style='text-align: center;'>Maryland</td>
<td style='text-align: center;'>South Region</td>
<td style='text-align: center;'>178.69</td>
<td style='text-align: center;'>39.3</td>
<td style='text-align: center;'>-76.61</td>
<td style='text-align: center;'>0.03</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>16</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Detroit-Warren-Dearborn, MI</td>
<td style='background-color: #f7f7f7; text-align: center;'>Michigan</td>
<td style='background-color: #f7f7f7; text-align: center;'>Midwest Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>103.23</td>
<td style='background-color: #f7f7f7; text-align: center;'>42.38</td>
<td style='background-color: #f7f7f7; text-align: center;'>-83.1</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.07</td>
</tr>
<tr>
<td style='text-align: left;'>17</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Minneapolis-St. Paul-Bloomington, MN-WI</td>
<td style='text-align: center;'>Minnesota</td>
<td style='text-align: center;'>Midwest Region</td>
<td style='text-align: center;'>143.04</td>
<td style='text-align: center;'>44.96</td>
<td style='text-align: center;'>-93.27</td>
<td style='text-align: center;'>0.05</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>18</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Kansas City, MO-KS</td>
<td style='background-color: #f7f7f7; text-align: center;'>Missouri</td>
<td style='background-color: #f7f7f7; text-align: center;'>Midwest Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>137.99</td>
<td style='background-color: #f7f7f7; text-align: center;'>39.12</td>
<td style='background-color: #f7f7f7; text-align: center;'>-94.55</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.08</td>
</tr>
<tr>
<td style='text-align: left;'>19</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>St. Louis, MO-IL</td>
<td style='text-align: center;'>Missouri</td>
<td style='text-align: center;'>Midwest Region</td>
<td style='text-align: center;'>135.58</td>
<td style='text-align: center;'>38.64</td>
<td style='text-align: center;'>-90.24</td>
<td style='text-align: center;'>0.05</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>20</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Charlotte-Concord-Gastonia, NC-SC</td>
<td style='background-color: #f7f7f7; text-align: center;'>North Carolina</td>
<td style='background-color: #f7f7f7; text-align: center;'>South Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>146.26</td>
<td style='background-color: #f7f7f7; text-align: center;'>35.2</td>
<td style='background-color: #f7f7f7; text-align: center;'>-80.83</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.08</td>
</tr>
<tr>
<td style='text-align: left;'>21</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Las Vegas-Henderson-Paradise, NV</td>
<td style='text-align: center;'>Nevada</td>
<td style='text-align: center;'>West Region</td>
<td style='text-align: center;'>150.66</td>
<td style='text-align: center;'>36.21</td>
<td style='text-align: center;'>-115.22</td>
<td style='text-align: center;'>0.09</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>22</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>New York-Newark-Jersey City, NY-NJ-PA</td>
<td style='background-color: #f7f7f7; text-align: center;'>New York</td>
<td style='background-color: #f7f7f7; text-align: center;'>Northeast Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>168.58</td>
<td style='background-color: #f7f7f7; text-align: center;'>40.67</td>
<td style='background-color: #f7f7f7; text-align: center;'>-73.94</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.04</td>
</tr>
<tr>
<td style='text-align: left;'>23</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Cincinnati, OH-KY-IN</td>
<td style='text-align: center;'>Ohio</td>
<td style='text-align: center;'>Midwest Region</td>
<td style='text-align: center;'>122.06</td>
<td style='text-align: center;'>39.14</td>
<td style='text-align: center;'>-84.51</td>
<td style='text-align: center;'>0.06</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>24</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Portland-Vancouver-Hillsboro, OR-WA</td>
<td style='background-color: #f7f7f7; text-align: center;'>Oregon</td>
<td style='background-color: #f7f7f7; text-align: center;'>West Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>212.83</td>
<td style='background-color: #f7f7f7; text-align: center;'>45.54</td>
<td style='background-color: #f7f7f7; text-align: center;'>-122.66</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.13</td>
</tr>
<tr>
<td style='text-align: left;'>25</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Philadelphia-Camden-Wilmington, PA-NJ-DE-MD</td>
<td style='text-align: center;'>Pennsylvania</td>
<td style='text-align: center;'>Northeast Region</td>
<td style='text-align: center;'>166.12</td>
<td style='text-align: center;'>40.01</td>
<td style='text-align: center;'>-75.13</td>
<td style='text-align: center;'>0.03</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>26</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Pittsburgh, PA</td>
<td style='background-color: #f7f7f7; text-align: center;'>Pennsylvania</td>
<td style='background-color: #f7f7f7; text-align: center;'>Northeast Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>157.07</td>
<td style='background-color: #f7f7f7; text-align: center;'>40.44</td>
<td style='background-color: #f7f7f7; text-align: center;'>-79.98</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.04</td>
</tr>
<tr>
<td style='text-align: left;'>27</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>Dallas-Fort Worth-Arlington, TX</td>
<td style='text-align: center;'>Texas</td>
<td style='text-align: center;'>South Region</td>
<td style='text-align: center;'>176.13</td>
<td style='text-align: center;'>32.79</td>
<td style='text-align: center;'>-96.77</td>
<td style='text-align: center;'>0.11</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; text-align: left;'>28</td>
<td style='background-color: #f7f7f7; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; text-align: center;'>Houston-The Woodlands-Sugar Land, TX</td>
<td style='background-color: #f7f7f7; text-align: center;'>Texas</td>
<td style='background-color: #f7f7f7; text-align: center;'>South Region</td>
<td style='background-color: #f7f7f7; text-align: center;'>186.68</td>
<td style='background-color: #f7f7f7; text-align: center;'>29.77</td>
<td style='background-color: #f7f7f7; text-align: center;'>-95.39</td>
<td style='background-color: #f7f7f7; text-align: center;'>0.04</td>
</tr>
<tr>
<td style='text-align: left;'>29</td>
<td style='text-align: center;'>Sep 01,2016</td>
<td style='text-align: center;'>San Antonio-New Braunfels, TX</td>
<td style='text-align: center;'>Texas</td>
<td style='text-align: center;'>South Region</td>
<td style='text-align: center;'>190.4</td>
<td style='text-align: center;'>29.46</td>
<td style='text-align: center;'>-98.51</td>
<td style='text-align: center;'>0.07</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;'>30</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>Sep 01,2016</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>Seattle-Tacoma-Bellevue, WA</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>Washington</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>West Region</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>203.79</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>47.62</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>-122.35</td>
<td style='background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: center;'>0.13</td>
</tr>
</tbody>
<tfoot><tr><td colspan='9'>
Source: Freddie Mac House Price Index</td></tr></tfoot>
</table>
<p>For tractability I restricted the number of metro areas, roughly corresponding to the top 20 metro areas based on population.</p>
<p>Here’s a map view of the metros in our data:</p>
<p><img src="http://lenkiefer.com/post/2017-01-22-build-flex_files/figure-html/jan222017-map1-1.png" width="672" /></p>
</div>
</div>
<div id="building-a-dashboard" class="section level1">
<h1>Building a dashboard</h1>
<p>The idea behind this dashboard is to compare housing market conditions across areas and across time. These data automatically lend themselves to these comparisons. Indeed, the very nature of a house price index is to compare trends in average quality-adjusted house prices over time.</p>
<p><a href="http://rmarkdown.rstudio.com/flexdashboard/">Flexdashboards</a> are a powerful tool for visualizing data. We will combine multiple interactive plots together into a single self-contained webpage.</p>
<div id="getting-started---data" class="section level2">
<h2>Getting started - Data</h2>
<p>First we need to load our data. As we’re going to use crosstalk to enable our widgets to talk to each other, we’ll also need to do set up some <a href="http://rstudio.github.io/crosstalk/using.html">Shared Data</a>. The shared data can act like data frame in compatible HTML widgets but respond to selections and filters.</p>
<p>In the code below we load the data with metro house prices and create the Shared Data:</p>
<pre class="r"><code>df&lt;-fread(&quot;data/hpimetro.csv&quot;)
df$date&lt;-as.Date(df$date, format=&quot;%m/%d/%Y&quot;)
# Set up metro data for cross talk:
df.metro&lt;-group_by(df[year(date)&gt;1999,],geo)
sd.metro &lt;- SharedData$new(df.metro, ~geo)</code></pre>
</div>
<div id="layout" class="section level2">
<h2>Layout</h2>
<p>Our dashboard is going to have several pages. To explore the different layout options we’ll create four pages:</p>
<ol style="list-style-type: decimal">
<li>A general information/about page</li>
<li>A <a href="http://rmarkdown.rstudio.com/flexdashboard/layouts.html#storyboard">storyboard</a> page</li>
<li>A page with an interactive widget we can filter</li>
<li>A page with an animated chart</li>
</ol>
</div>
</div>
<div id="getting-stated" class="section level1">
<h1>Getting stated</h1>
<p>Let’s walk through the construction of each of these individual pages, starting with the landing page.</p>
<div id="about" class="section level2">
<h2>About</h2>
<p>The about page is quite important as it is where our new visitors will land. We want to include a brief description along with some hints at what else is in the dashboard. But we want to do it without overwhelming visitors. For this page we’ll include:</p>
<ol style="list-style-type: decimal">
<li>Short introductory text</li>
<li>A map (same as above) showing the metros in our data.</li>
</ol>
<pre class="r"><code>About {data-navmenu=&quot;Explore&quot;}
===================================== 

Column {data-width=200}
-------------------------------------

### About this flexdashboard

This dashboard allows you to explore trends in house prices across 30 large metro areas. The metro areas covered are depicted in the nearby map.  The map is colored  according to Census regions.  We picked the 30 largest metro areas based on population. Explore the different data visualizations above.

Column {data-width=800}
-------------------------------------

### Areas covered

# Run this to create map
#```{r jan222017-ex1-map,echo=F}
g.map&lt;-
  ggplot(df[date==&quot;2016-09-01&quot; ], aes(x = long, y = lat,label=geo)) +
  geom_map(data=df.state[date==&quot;2016-09-01&quot;,],aes(fill = region,map_id=tolower(statename)), map = states_map,alpha=0.25)+
  borders(&quot;state&quot;,  colour = &quot;grey70&quot;,alpha=0.4)+
  theme_void()+
  scale_fill_viridis(name=&quot;Census Region&quot;,discrete=T,option=&quot;C&quot;)+
  theme(legend.position=&quot;top&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18))+
  geom_point(alpha=0.85,color=&quot;black&quot;,size=2)+
  geom_text(hjust=0,size=1.75,nudge_y=-0.7)+
  labs(title=&quot;Metro areas in our data&quot;,
       subtitle=&quot;30 large metro areas&quot;,
       caption=&quot;@lenkiefer Metro population based on U.S. Census: http://www.census.gov/programs-surveys/popest.html&quot;)+
  theme(plot.caption=element_text(hjust=0,size=7))
# ```</code></pre>
<p>Some things to note about this page. We want the navigation to be collapsed. The default is for each page to get its own link on the top navigation, but by selecting <code>About {data-navmenu=&quot;Explore&quot;}</code> we force this page to fall under the “Explore” link at the top. We also want the map to take up most of the space, so we set <code>{data-width=200}</code> for the first column and <code>{data-width=800}</code> for the second. This ensures the map gets 80% of the available width.</p>
</div>
<div id="storyboard" class="section level2">
<h2>Storyboard</h2>
<p>Now we can move on to the second page, which uses a storyboard. Consider the code below:</p>
<pre class="r"><code>Storyboard {.storyboard data-navmenu=&quot;Explore&quot;}
=========================================

### Map of areas we plot

#```{r}
g.map
#```

### Small multiple, House Price Index

#```{r sm-1-jan22-2017,fig.width=10}
g1&lt;-ggplot(data=df,aes(x=date,y=hpi))+geom_line()+facet_wrap(~geo)+
  theme_minimal()+labs(x=&quot;&quot;,y=&quot;&quot;,title=&quot;House price index by metro&quot;,
                       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index&quot;)+
  theme(plot.caption=element_text(hjust=0,size=7),        plot.title=element_text(size=10),
        strip.text=element_text(size=4),
        axis.text.x=element_text(size=4)  ,
              axis.text.y=element_text(size=5)   )
g1

### Small multiple, Annual house price appreciation

#```{r sm-2-jan22-2017,fig.width=10}
g2&lt;-ggplot(data=df,aes(x=date,y=hpa12))+geom_line()+facet_wrap(~geo)+
    theme_minimal()+labs(x=&quot;&quot;,y=&quot;&quot;,title=&quot;Annual percent change in house price index by metro&quot;,
                       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index&quot;)+
  scale_y_continuous(label=percent)+
  theme(plot.caption=element_text(hjust=0,size=7),        plot.title=element_text(size=10),
        strip.text=element_text(size=4),
        axis.text.x=element_text(size=4)  ,
              axis.text.y=element_text(size=5)   )
g2
#```</code></pre>
<p>We start the storyboard page by declaring that this page has a storyboard structure with <code>Storyboard {.storyboard data-navmenu=&quot;Explore&quot;}</code>. Note we also force this page to belong under the “Explore” navigation. By adding <code>.storyboard</code> this tells the flexdashboard to arrange subsections on different storyboard panes.</p>
<p>In the code above I included the first three panes (corresponding to the map g.map and graphs g1 &amp; g2). In the full dashboard I actually include 7 panes. The text we include under the headers (denoted with <code>###</code>) will be included in the story pane navigation filmstrip.</p>
</div>
<div id="interactive-chart" class="section level2">
<h2>Interactive chart</h2>
<p>So far, the elements we have included are standard, and well described in the <a href="http://rmarkdown.rstudio.com/flexdashboard/index.html">flexdashboard</a> documentation. These next two pages are more complex. The first, an interactive chart uses <a href="https://github.com/rstudio/crosstalk">crosstalk</a> and <a href="https://plot.ly/r/">plotly</a> to create a dynamic interactive chart in a static webpage.</p>
<p><a href="https://github.com/rstudio/crosstalk">Crosstalk</a> allows <a href="http://www.htmlwidgets.org/">htmlwidgets</a> to talk to one another on a static webpage. What we are going to do is create three plotly graphs and have them linked via crosstalk and include a filter box.</p>
<p>First we need to create the widgets, which are individual plotly charts:</p>
<pre class="r"><code>g.map&lt;-
  ggplot(sd.metro, aes(x = long, y = lat)) +
  borders(&quot;state&quot;,  colour = &quot;grey70&quot;,fill=&quot;lightgray&quot;,alpha=0.5)+
  theme_void()+
  theme(legend.position=&quot;none&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18))+
  geom_point(alpha=0.82,color=&quot;black&quot;,size=3)+
  labs(title=&quot;Selected Metro(s)&quot;,
       subtitle=head(df,1)$geo,
       caption=&quot;@lenkiefer Source: Freddie Mac House Price Index through September 2016&quot;)+
  theme(plot.caption=element_text(hjust=0))

p0&lt;-
   plot_ly(data=sd.metro,x = ~date, y = ~hpi, height=750) %&gt;% 
    add_lines(name=&quot;Index&quot;,colors=&quot;gray&quot;,alpha=0.7) %&gt;% 
    add_lines(name=&quot;All metros&quot;,data=df,x=~date,y=~hpi,
              colors=&quot;black&quot;,color=~geo,alpha=0.1,showlegend=F,hoverinfo=&quot;none&quot;) %&gt;%
     layout(title = &quot;House Price Trends by Metro&quot;,xaxis = list(title=&quot;Date&quot;), yaxis = list(title=&quot;House Price Index&quot;))

p1&lt;-
   plot_ly(data=sd.metro,x = ~date, y = ~hpa12, height=750) %&gt;% 
    add_lines(name=&quot;Annual % change&quot;,colors=&quot;gray&quot;,alpha=0.7) %&gt;% 
    add_lines(name=&quot;All metros&quot;,data=df,x=~date,y=~hpa12,
              colors=&quot;black&quot;,color=~geo,alpha=0.1,showlegend=F,hoverinfo=&quot;none&quot;) %&gt;%
     layout(title = &quot;House Price Trends by Metro&quot;,xaxis = list(title=&quot;Date&quot;), yaxis = list(title=&quot;Annual % Change in House Price Index&quot;))</code></pre>
<p><em>g.map</em> is a ggplot2 graph while <em>p0</em> and <em>p1</em> are plotly graphs. We will apply <a href="https://plot.ly/ggplot2/">ggplotly</a> to convert our ggplot map into a plotly thing.</p>
<p>Once we have the graphs, we can combine them using the crosstalk function <em>bscols</em> and include a <em>filter_select</em> to filter the charts. The code is not very long:</p>
<pre class="r"><code>bscols(widths=c(2,6,4),
  list(filter_select(&quot;metro&quot;, &quot;Select metro to highlight for plot&quot;, sd.metro, ~geo,multiple=FALSE)),
  subplot(p0,p1,nrows=2,titleY=T),
  ggplotly(g.map)
  )</code></pre>
<p>The <em>bscols</em> function first allocates our graphs over the page with <em>widths</em>. Next, we include a <em>filter_select</em> that uses the SharedData sd.metro (discussed above). We set <em>multiple</em> equal to FALSE so that only one metro can be selected at a time.</p>
<div id="animation" class="section level3">
<h3>Animation</h3>
<p>Our final page is an animated chart. Animations require the development version of plotly for R. Install via:</p>
<p><code>devtools::install_github(&quot;ropensci/plotly&quot;)</code></p>
<p>The animation is pretty straightforward. Once again, we link the data through SharedData. In our plots, we income a <em>frame</em> argument inside of <em>aes</em>. Then we instruct plotly to animate the graphs:</p>
<pre class="r"><code>g.map2&lt;-
  ggplot(sd.metro, aes(x = long, y = lat,frame=geo,label=paste(&quot;\n\n  &quot;,geo),color=geo)) +
  borders(&quot;state&quot;,  colour = &quot;grey70&quot;,fill=&quot;lightgray&quot;,alpha=0.5)+
  theme_void()+
  theme(legend.position=&quot;none&quot;,
        plot.title=element_text(face=&quot;bold&quot;,size=18))+
  geom_point(alpha=0.5,size=1)+
  geom_text(hjust=0)+
  labs(title=&quot;House price trends around the U.S.&quot;)+
  theme(plot.caption=element_text(hjust=0))

p2&lt;-
  ggplot(data=sd.metro,aes(x=date,y=hpa12))+
  #geom_point()+geom_segment(aes(xend=date,yend=0))+
  geom_line(aes(frame=geo,ids=date,label=geo,color=geo))+
  scale_y_continuous(labels=scales::percent)+
  geom_line(data=df.us,color=&quot;gray&quot;,linetype=2)+
  #scale_fill_viridis()+  scale_color_viridis()+
  theme_minimal()+labs(x=&quot;&quot;,y=&quot;Annual House Price Appreciation y/y %&quot;,title=&quot;Annual Price Growth&quot;)
#+    geom_text(data=d3.m[date==median(d3.m$date)],fontface=&quot;bold&quot;,y=16,size=8)

p3&lt;-
  ggplot(data=sd.metro,aes(x=date,y=hpi))+
  geom_line(aes(frame=geo,ids=date,label=geo,color=geo))+
  theme_minimal()+labs(x=&quot;&quot;,y=&quot;House Price Index&quot;,title=&quot;House Price Index&quot;)+
  geom_line(data=df.us,color=&quot;gray&quot;,linetype=2)


subplot(subplot(ggplotly(p3),ggplotly(p2),nrows=2,titleY=T), ggplotly(g.map2),  nrows = 1, widths = c(0.35, 0.65), titleX = TRUE,titleY=T) %&gt;%
  hide_legend() %&gt;%
  animation_opts(2000,transition=500) %&gt;% layout(title=&quot;House price tour, solid line metro, dotted line U.S.&quot;)</code></pre>
<p>I want to arrange the graphs, so I use a nested call of plotly’s <a href="https://cpsievert.github.io/plotly_book/arranging-multiple-views.html">subplot</a> function.</p>
</div>
</div>
</div>
<div id="putting-it-all-together" class="section level1">
<h1>Putting it all together</h1>
<p>Combining all these steps we can create the following dashboard:</p>
<p>You can see a fullscreen version <a href="../../../../chartbooks/jan2017/hpi-tour.html">here</a>.</p>
<iframe src="../../../../chartbooks/jan2017/hpi-tour.html" height="800" width="1200">
</iframe>
</div>
<div id="next-steps" class="section level1">
<h1>Next Steps</h1>
<p>I’ve found flexdashboards to be a fun way to interact with data. Hopefully more htmlwidgets will be made compatible with crosstalk. But because plotly allows you to translate most ggplot graphs into widgets, there’s already a huge potential with what’s available.</p>
<p>Perhaps you will find flexdashboards to be something you would like to explore. Hopefully this guide can be helpful, by giving you a working example of several features.</p>
</div>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://twitter.com/intent/tweet?url=http%3a%2f%2flenkiefer.com%2f2017%2f01%2f22%2fa-guide-to-building-an-interactive-flexdashboard%2f" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://lenkiefer.com/2017/01/20/flexin-friday/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://lenkiefer.com/2017/01/20/flexin-friday/">Flexin&#39; Friday</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://lenkiefer.com/2017/01/26/converting-a-tableau-dashboard-to-a-flexdashboard/">Converting a Tableau dashboard to a Flexdashboard</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://lenkiefer.com/2017/01/26/converting-a-tableau-dashboard-to-a-flexdashboard/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  

  

</div>

</div>
</div>
<script src="http://lenkiefer.com/js/ui.js"></script>
<script src="http://lenkiefer.com/js/menus.js"></script>




<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66905937-1', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="http://lenkiefer.com/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

